# scripts/utils/labels.py
import re
from typing import Optional, List, Dict, Tuple, Any

# ==== –†–µ–≥—ç–∫—Å–ø—ã ====
OKPD_RE        = re.compile(r'(?<![\d,])(\d{2}(?:\.\d{1,2}){1,3}(?:\.\d{3})?)(?![\d,])')
OKPD_RE_STRICT = re.compile(r'(?<![\d,])(\d{2}(?:\.\d{2}){1,2}\.\d{1,2}(?:\.\d{3})?)(?![\d,])')
OKPD_INLINE_RE = re.compile(r'(?i)\b–û–ö–ü–î2?\s*[:#=\-]?\s*([0-9]{2}(?:\.[0-9]{1,2}){1,3}(?:\.\d{3})?)')

GOST_RE        = re.compile(r'(?i)\b–ì–û–°–¢(?:\s*(–†))?\s*(?:–ò–°–û\s*)?([0-9]+(?:\.[0-9]+)*)\s*(?:[-‚Äì‚Äî]\s*(\d{2,4}))?\b')
GOST_SHORT_RE  = re.compile(r'–ì–û–°–¢(?:\s*–†)?\s*(?:–ò–°–û\s*)?([0-9]{3,5})', re.I)
OST_RE         = re.compile(r'(?i)\b–û–°–¢\b\s*([A-Z–ê-–Ø0-9][\w\.\-\s]*)')
TU_RE          = re.compile(r'(?i)(?<!\w)–¢–£[-\s]*([A-Z–ê-–Ø0-9][\w\.\-]*)')
DIN_RE         = re.compile(r'(?i)\bDIN\b\s*([0-9]+)')
ISO_RE         = re.compile(r'(?i)\bISO\b\s*([0-9]+(?:[-\.]\d+)?)')

STEEL_GRADE_RE = re.compile(r'(?i)\b—Å—Ç\.?\s*([0-9]{1,2}[–∞-—è]*(?:-[0-9])?)\b')
DIAMETER_RE = re.compile(
    r'(?i)(?:^|[^\d])(√ò|D|DN|Du|dn|–î–£|–î—É|d)?\s*[-‚Äì‚Äî]?\s*(\d{1,3}(?:[.,]\d{1,2})?)\s*(?:–º–º|mm)?\b'
)

def extract_features(text: str) -> Dict[str, str]:
    """–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –∏–∑ —Ç–µ–∫—Å—Ç–∞"""
    feats = {}
    if (m := STEEL_GRADE_RE.search(text or '')):
        feats['steel_grade'] = m.group(1)
    if (m := DIAMETER_RE.search(text or '')):
        feats['diameter'] = m.group(2).replace(',', '.')  # –≥—Ä—É–ø–ø–∞ 2 ‚Äî —Å–∞–º–æ —á–∏—Å–ª–æ
    return feats

def okpd_canon(code: Optional[str]) -> Optional[str]:
    """–ö–∞–Ω–æ–Ω–∏–∑–∞—Ü–∏—è –û–ö–ü–î –∫–æ–¥–∞"""
    if not code:
        return None
    parts = code.split('.')
    if not parts: 
        return None
    for i in range(1, len(parts)):
        is_last = (i == len(parts)-1)
        if is_last:
            if len(parts[i]) in (1,2,3):
                continue
        parts[i] = parts[i].zfill(2)
    parts[0] = parts[0].zfill(2)
    return '.'.join(parts)

def okpd_findall(s: str) -> List[str]:
    """–ü–æ–∏—Å–∫ –≤—Å–µ—Ö –û–ö–ü–î –∫–æ–¥–æ–≤ –≤ —Ç–µ–∫—Å—Ç–µ"""
    txt = (s or '').replace(' ', '')
    out: List[str] = []
    for m in OKPD_RE_STRICT.finditer(txt):
        start = m.start(1)
        ctx = txt[max(0, start-8):start].upper()
        if '–ì–û–°–¢' in ctx:
            continue
        out.append(m.group(1))
    return out

def okpd_norm(s: str) -> Optional[str]:
    """–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –û–ö–ü–î –∫–æ–¥–∞"""
    # –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —è–≤–Ω–æ–º—É "–û–ö–ü–î/–û–ö–ü–î2: ..."
    mi = OKPD_INLINE_RE.search(s or '')
    if mi:
        return okpd_canon(mi.group(1))
    m = OKPD_RE.search((s or '').replace(' ', ''))
    return okpd_canon(m.group(1)) if m else None

def okpd_breadcrumb(code: str) -> List[str]:
    """–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏–µ—Ä–∞—Ä—Ö–∏–∏ –û–ö–ü–î –∫–æ–¥–∞"""
    c = okpd_canon(code) or ''
    parts = c.split('.') if c else []
    return ['.'.join(parts[:i]) for i in range(1, len(parts) + 1)]

def gost_norm(raw: str) -> Optional[str]:
    """–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –ì–û–°–¢"""
    if not raw:
        return None
    txt = raw.replace('‚Äì', '-').replace('‚Äî', '-')
    m = GOST_RE.search(txt)
    if not m:
        return None
    r_flag, base, year = m.group(1), m.group(2), m.group(3)
    prefix = '–ì–û–°–¢ –†' if r_flag else '–ì–û–°–¢'
    return f"{prefix} {base}-{year}" if year else f"{prefix} {base}"

def gost_breadcrumb(code: str) -> List[str]:
    if not code: return []
    body = code.split(' ',1)[1] if ' ' in code else code
    body = re.sub(r'^\s*–†\s+', '', body, flags=re.I)  # –ì–û–°–¢ –† ‚Üí —É–±—Ä–∞—Ç—å "–† "
    base = body.split('-')[0]
    parts = base.split('.')
    crumbs = ['.'.join(parts[:i]) for i in range(1, len(parts)+1)]
    if '-' in body: crumbs.append(body)
    return crumbs

def extract_okpd_labels(text: str) -> List[Dict]:
    """–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –û–ö–ü–î –º–µ—Ç–æ–∫ –∏–∑ —Ç–µ–∫—Å—Ç–∞"""
    mi = OKPD_INLINE_RE.findall(text or '')
    codes = [okpd_canon(x) for x in mi] if mi else okpd_findall(text or '')
    seen, out = set(), []
    for c in codes:
        if not c or c in seen:
            continue
        seen.add(c)
        out.append({'ns': 'okpd', 'code': c, 'path': okpd_breadcrumb(c), 'conf': 0.8})
    return out

# --- –†–ê–°–®–ò–†–ï–ù–ù–´–ô –ö–õ–ê–°–°–ò–§–ò–ö–ê–¢–û–† –î–õ–Ø –¢–ï–•–ù–û–õ–û–ì–ò–ß–ù–û–ì–û –ó–ê–í–û–î–ê ---

# –ú–∞–ø–ø–∏–Ω–≥ –ì–û–°–¢ -> –û–ö–ü–î2
GOST2OKPD = {
    # –î–í–ü
    '4598':  '16.21.14.000',  # –ø–ª–∏—Ç—ã –¥—Ä–µ–≤–µ—Å–Ω–æ–≤–æ–ª–æ–∫–Ω–∏—Å—Ç—ã–µ 

    # –ü–õ–ê–°–¢–ú–ê–°–°–´/–õ–ê–ú–ò–ù–ê–¢–´ (–≥–µ—Ç–∏–Ω–∞–∫—Å –ª–∏—Å—Ç–æ–≤–æ–π)
    '2718':  '22.21.30.110',  # –ª–∏—Å—Ç –∏–∑ –ø–ª–∞—Å—Ç–º–∞—Å—Å—ã 

    # –ì–ê–ó–´
    '10157': '20.11.11',      # –ê—Ä–≥–æ–Ω: —É—Ç–æ—á–Ω—è–π—Ç–µ .121 (–≥–∞–∑) –∏–ª–∏ .122 (–∂–∏–¥–∫.)
    '8050':  '20.11.12.110',  # –î–∏–æ–∫—Å–∏–¥ —É–≥–ª–µ—Ä–æ–¥–∞ (—É–≥–ª–µ–∫–∏—Å–ª—ã–π –≥–∞–∑)

    # –ë–£–ú–ê–ì–ê/–ö–ê–†–¢–û–ù (—É—Ç–æ—á–Ω—ë–Ω–Ω—ã–µ –ª–∏—Å—Ç—ã)
    '9569':  '17.12.14.172',  # –±—É–º–∞–≥–∞ –∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä–Ω–∞—è (—Å–µ–º–µ–π—Å—Ç–≤–æ 17.12.14.170)
    '8273':  '17.12.14.190',  # –±—É–º–∞–≥–∞ –æ–±—ë—Ä—Ç–æ—á–Ω–∞—è
    '597':   '17.12.14.120',  # –±—É–º–∞–≥–∞ —á–µ—Ä—Ç–µ–∂–Ω–∞—è
    '12026': '17.12.14.140',  # –±—É–º–∞–≥–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–ª—å–Ω–∞—è (—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è)
    '2824':  '17.12.14.179',  # –∫–∞—Ä—Ç–æ–Ω —ç–ª–µ–∫—Ç—Ä–æ–∏–∑–æ–ª—è—Ü–∏–æ–Ω–Ω—ã–π (–ø—Ä–æ—á–∞—è)

    # –ö–†–ê–°–ö–ò/–ì–†–£–ù–¢–û–í–ö–ò 
    '6465': '20.30.12', # –ì–§-021 –∏ –¥—Ä. –∞–ª–∫–∏–¥–Ω—ã–µ –≥—Ä—É–Ω—Ç—ã 
    '9109': '20.30.12', # –§–õ-–û–ó–ö 
    '12707': '20.30.12', # –í–õ-02 
    '25718': '20.30.12', # –ê–ö-070 

    # –•–ò–ú–ò–Ø (–∫–∏—Å–ª–æ—Ç—ã, –≤–æ–¥–∞, –∞–º–º–∏–∞–∫, —Å–æ–ª–∏)
    '4204':  '20.13.24.122',  # –∫–∏—Å–ª–æ—Ç–∞ —Å–µ—Ä–Ω–∞—è (—Ä–µ–∞–∫—Ç. / —Ç–µ—Ö.) 
    '2184':  '20.13.24.122',  # –∫–∏—Å–ª–æ—Ç–∞ —Å–µ—Ä–Ω–∞—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è (—Ç–æ—Ç –∂–µ –∫–ª–∞—Å—Å)
    '3118':  '20.13.24.112',  # –∫–∏—Å–ª–æ—Ç–∞ —Å–æ–ª—è–Ω–∞—è
    '701':   '20.15.10.110',  # –∫–∏—Å–ª–æ—Ç–∞ –∞–∑–æ—Ç–Ω–∞—è
    '6709':  '20.13.52.120',  # –≤–æ–¥–∞ –¥–∏—Å—Ç–∏–ª–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è
    '58144': '20.13.52.120',  # –ì–û–°–¢ –† 58144-2018 ‚Äî –≤–æ–¥–∞ –¥–ª—è –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã—Ö —Ü–µ–ª–µ–π
    '6221':  '20.15.10.120',  # –∞–º–º–∏–∞–∫ –±–µ–∑–≤–æ–¥–Ω—ã–π
    '20490': '20.13.51.113',  # –ø–µ—Ä–º–∞–Ω–≥–∞–Ω–∞—Ç –∫–∞–ª–∏—è (–º–∞–Ω–≥–∞–Ω–∞—Ç—ã/–ø–µ—Ä–º–∞–Ω–≥–∞–Ω–∞—Ç—ã)
    '2210':  '20.15.20.110',  # —Ö–ª–æ—Ä–∏–¥ –∞–º–º–æ–Ω–∏—è
    '2567':  '20.13.24.141',  # –∫–∏—Å–ª–æ—Ç–∞ —Ñ—Ç–æ—Ä–∏—Å—Ç–æ–≤–æ–¥–æ—Ä–æ–¥–Ω–∞—è (–ø–ª–∞–≤–∏–∫–æ–≤–∞—è)

    # –†–∞—Å—Ç–≤–æ—Ä–∏—Ç–µ–ª–∏ –∏ –º–∞—Å–ª–∞/—Å–º–∞–∑–∫–∏
    '2768':  '20.14.62.000',  # –∞—Ü–µ—Ç–æ–Ω —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π
    '2603':  '20.14.62.000',  # –∞—Ü–µ—Ç–æ–Ω (—Ä–µ–∞–∫—Ç–∏–≤)
    '8981':  '20.14.32.123',  # —ç—Ç–∏–ª–∞—Ü–µ—Ç–∞—Ç (—ç—Ñ–∏—Ä —É–∫—Å—É—Å–Ω–æ–π –∫–∏—Å–ª–æ—Ç—ã)
    '9433':  '19.20.29.210',  # —Å–º–∞–∑–∫–∞ –ø–ª–∞—Å—Ç–∏—á–Ω–∞—è (–¶–ò–ê–¢–ò–ú-221)

    # –ë—É–º–∞–≥–∞/–∫–∞—Ä—Ç–æ–Ω
    '7376':  '17.21.11.110',  # –∫–∞—Ä—Ç–æ–Ω –≥–æ—Ñ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π (–≤ —Ä—É–ª–æ–Ω–∞—Ö/–ª–∏—Å—Ç–∞—Ö)

    # –°–æ—Å–Ω–æ–≤–∞—è –∫–∞–Ω–∏—Ñ–æ–ª—å
    '19113': '20.14.71.171',  # –∫–∞–Ω–∏—Ñ–æ–ª—å –∏ –∫–∏—Å–ª–æ—Ç—ã —Å–º–æ–ª—è–Ω—ã–µ

    # –©—ë—Ç–∫–∏/–∫–∏—Å—Ç–∏
    '10597': '32.91.12.110',  # –∫–∏—Å—Ç–∏ –º–∞–ª—è—Ä–Ω—ã–µ

    # –ö–æ–∞–∫—Å–∏–∞–ª—å–Ω—ã–µ –∫–∞–±–µ–ª–∏ ‚Äî —á–∞—Å—Ç–Ω—ã–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã —Å–µ—Ä–∏–∏ 11326.* 
    '11326': '27.32.12.000',  
    '11326.3':  '27.32.12.000',
    '11326.37': '27.32.12.000',
    '11326.74': '27.32.12.000',
 
    '9546': '20.13.31.000',  # –∞–º–º–æ–Ω–∏–π —Ñ—Ç–æ—Ä–∏—Å—Ç—ã–π –∫–∏—Å–ª—ã–π (–æ—Å–Ω–æ–≤–Ω–æ–π)
    # alt: '20.13.62.190'  # fallback ¬´–ø—Ä–æ—á–∏–µ –Ω–µ–æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∏–º–∏–∫–∞—Ç—ã¬ª

    # === –ö–†–ï–ü–Å–ñ ISO (–ì–û–°–¢ –† –ò–°–û / –ì–û–°–¢ ISO) ===
    '4014': '25.94.11.110',  # –±–æ–ª—Ç—ã —à–µ—Å—Ç–∏–≥—Ä–∞–Ω–Ω—ã–µ (—á–∞—Å—Ç–∏—á–Ω–∞—è —Ä–µ–∑—å–±–∞) –ì–û–°–¢ –† –ò–°–û 
    '4017': '25.94.11.110',  # –≤–∏–Ω—Ç—ã (—à–µ—Å—Ç–∏–≥—Ä., –ø–æ–ª–Ω–∞—è —Ä–µ–∑—å–±–∞) –ì–û–°–¢ –† –ò–°–û 
    '4032': '25.94.11.130',  # –≥–∞–π–∫–∏ —à–µ—Å—Ç–∏–≥—Ä–∞–Ω–Ω—ã–µ, —Ç–∏–ø 1 –ì–û–°–¢ –† –ò–°–û 
    '8765': '25.94.11.110',  # –±–æ–ª—Ç—ã —à–µ—Å—Ç–∏–≥—Ä–∞–Ω–Ω—ã–µ (–º–µ–ª–∫–∞—è/—Å–ø–µ—Ü. —Ä–µ–∑—å–±–∞) –ì–û–°–¢ –† –ò–°–û 
    '2009': '25.94.11.120',  # –≤–∏–Ω—Ç—ã —Å –ø–æ–ª—É–∫—Ä—É–≥–ª–æ–π/–ø–æ—Ç–∞–π–Ω–æ–π (—à–ª–∏—Ü) –ì–û–°–¢ –† –ò–°–û 
    '1207': '25.94.11.120',  # –≤–∏–Ω—Ç—ã —Å —Ü–∏–ª–∏–Ω–¥—Ä–∏—á–µ—Å–∫–æ–π –≥–æ–ª–æ–≤–∫–æ–π (—à–ª–∏—Ü) –ì–û–°–¢ –† –ò–°–û 
    '7805':  '25.94.11.110',  # –±–æ–ª—Ç—ã —Å —à–µ—Å—Ç–∏–≥—Ä–∞–Ω–Ω–æ–π –≥–æ–ª–æ–≤–∫–æ–π
    '7798':  '25.94.11.110',  # –±–æ–ª—Ç—ã —Å —à–µ—Å—Ç–∏–≥—Ä–∞–Ω–Ω–æ–π –≥–æ–ª–æ–≤–∫–æ–π, –∫–ª–∞—Å—Å –ê
    '7796':  '25.94.11.110',  # –±–æ–ª—Ç—ã —Å –ø–æ–ª—É–∫—Ä—É–≥–ª–æ–π –≥–æ–ª–æ–≤–∫–æ–π
    '7808':  '25.94.11.110',  # –±–æ–ª—Ç—ã —Å –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–π –≥–æ–ª–æ–≤–∫–æ–π
    '15589': '25.94.11.110',  # –±–æ–ª—Ç—ã —Å —à–µ—Å—Ç–∏–≥—Ä–∞–Ω–Ω–æ–π –≥–æ–ª–æ–≤–∫–æ–π, –∫–ª–∞—Å—Å –í
    '15590': '25.94.11.110',  # –±–æ–ª—Ç—ã —Å —É–≤–µ–ª–∏—á–µ–Ω–Ω–æ–π –≥–æ–ª–æ–≤–∫–æ–π
    '2010':  '25.94.11.120',  # –ì–û–°–¢ –† –ò–°–û 2010 ‚Äî –≤–∏–Ω—Ç—ã —Å –ø–æ–ª—É–ø–æ—Ç–∞–π–Ω–æ–π –≥–æ–ª–æ–≤–∫–æ–π (–≤–∏–Ω—Ç—ã) 
    '3032':  '25.94.11.130',  # –≥–∞–π–∫–∏ —à–µ—Å—Ç–∏–≥—Ä–∞–Ω–Ω—ã–µ –Ω–∏–∑–∫–∏–µ
    '3057':  '25.94.12.144',  # –ø—Ä—É–∂–∏–Ω—ã —Ç–∞—Ä–µ–ª—å—á–∞—Ç—ã–µ
    '6958':  '25.94.12.110',  # —à–∞–π–±—ã (—Å–µ—Ä–∏–∏ –ø–æ 6958-78 ‚Äî –∫–∞–∫ –ø–ª–æ—Å–∫–∏–µ/—É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–µ)
    '17020': '25.72.14.190',  # –ø—Ä–∏–∂–∏–º—ã/—Ö–æ–º—É—Ç—ã/–¥–µ—Ä–∂–∞—Ç–µ–ª–∏ –¥–ª—è —Ç—Ä—É–± –∏ –∫–∞–±–µ–ª–µ–π
    '22375': '27.33.13',      # –ª–µ–ø–µ—Å—Ç–∫–∏/–Ω–∞–∫–æ–Ω–µ—á–Ω–∏–∫–∏ –ø–∞—è—á–Ω—ã–µ (–∫–ª–µ–º–º—ã, –∫–æ–Ω—Ç–∞–∫—Ç—ã)

    '4018':  '25.94.11.120',  # –≤–∏–Ω—Ç—ã —Å —à–µ—Å—Ç–∏–≥—Ä–∞–Ω–Ω–æ–π –≥–æ–ª–æ–≤–∫–æ–π (ISO)
    '17473': '25.94.11.120',  # –≤–∏–Ω—Ç—ã —Å –ø–æ–ª—É–∫—Ä—É–≥–ª–æ–π –≥–æ–ª–æ–≤–∫–æ–π
    '17475': '25.94.11.120',  # –≤–∏–Ω—Ç—ã —Å –ø–æ—Ç–∞–π–Ω–æ–π –≥–æ–ª–æ–≤–∫–æ–π
    '1491':  '25.94.11.120',  # –≤–∏–Ω—Ç—ã —Å —Ü–∏–ª–∏–Ω–¥—Ä–∏—á–µ—Å–∫–æ–π –≥–æ–ª–æ–≤–∫–æ–π
    '11738': '25.94.11.120',  # –≤–∏–Ω—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–µ

    '5927':  '25.94.11.130',  # –≥–∞–π–∫–∏ —à–µ—Å—Ç–∏–≥—Ä–∞–Ω–Ω—ã–µ
    '5915':  '25.94.11.130',  # –≥–∞–π–∫–∏ —à–µ—Å—Ç–∏–≥—Ä–∞–Ω–Ω—ã–µ, –∫–ª–∞—Å—Å –ê
    '5916':  '25.94.11.130',  # –≥–∞–π–∫–∏ —à–µ—Å—Ç–∏–≥—Ä–∞–Ω–Ω—ã–µ, –∫–ª–∞—Å—Å –í
    '10605': '25.94.11.130',  # –≥–∞–π–∫–∏ —Å–∞–º–æ–∫–æ–Ω—Ç—Ä—è—â–∏–µ—Å—è

    '4028': '25.94.12', # –≥–≤–æ–∑–¥–∏ —Ç–æ–ª–µ–≤—ã–µ 
    '4029': '25.94.12', # –≥–≤–æ–∑–¥–∏ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ
    '12639': '25.94.12', 
    '12641': '25.94.12',
    '12638': '25.94.12', # –∑–∞–∫–ª–µ–ø–∫–∏ –≤—ã—Ç—è–∂–Ω—ã–µ/–ø–æ—Ç–∞–π–Ω—ã–µ

    '11371': '25.94.12.110',  # —à–∞–π–±—ã –ø–ª–æ—Å–∫–∏–µ
    '6402':  '25.94.12.110',  # —à–∞–π–±—ã –ø—Ä—É–∂–∏–Ω–Ω—ã–µ (–≥—Ä–æ–≤–µ—Ä—ã)
    '10450': '25.94.12.110',  # —à–∞–π–±—ã —Å—Ç–æ–ø–æ—Ä–Ω—ã–µ
    '11648': '25.94.12.110',  # —à–∞–π–±—ã —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–µ

    '10299': '25.94.12.120',  # –∑–∞–∫–ª–µ–ø–∫–∏ —Å –ø–æ–ª—É–∫—Ä—É–≥–ª–æ–π –≥–æ–ª–æ–≤–∫–æ–π
    '10300': '25.94.12.120',  # –∑–∞–∫–ª–µ–ø–∫–∏ —Å –ø–æ—Ç–∞–π–Ω–æ–π –≥–æ–ª–æ–≤–∫–æ–π
    '10301': '25.94.12.120',  # –∑–∞–∫–ª–µ–ø–∫–∏ —Å –ø–ª–æ—Å–∫–æ–π –≥–æ–ª–æ–≤–∫–æ–π

    '3128':  '25.94.12.190',  # —à—Ç–∏—Ñ—Ç—ã —Ü–∏–ª–∏–Ω–¥—Ä–∏—á–µ—Å–∫–∏–µ
    '3129':  '25.94.12.190',  # —à—Ç–∏—Ñ—Ç—ã –∫–æ–Ω–∏—á–µ—Å–∫–∏–µ

    # –°–¢–ê–õ–¨ / –ü–†–û–ö–ê–¢
    '2284':  '24.32.10.000',  # –ª–µ–Ω—Ç–∞ —Å—Ç–∞–ª—å–Ω–∞—è —Ö/–∫ (–¥–æ 600 –º–º)
    '5582':  '24.10.42.000',  # –ª–∏—Å—Ç—ã/–ø–æ–ª–æ—Å—ã –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∏–µ —Ç–æ–Ω–∫–æ–ª–∏—Å—Ç–æ–≤—ã–µ (—á–∞—â–µ —Ö/–∫)
    '5950':  '24.10.36',      # –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ —Å—Ç–∞–ª–∏ (–ø—Ä–æ–∫–∞—Ç)
    '19903': '24.10.31.000',  # –ª–∏—Å—Ç—ã –≥–æ—Ä—è—á–µ–∫–∞—Ç–∞–Ω—ã–µ, ‚â•600 –º–º
    '19904': '24.10.41.000',  # –ª–∏—Å—Ç—ã —Ö–æ–ª–æ–¥–Ω–æ–∫–∞—Ç–∞–Ω—ã–µ, ‚â•600 –º–º
    '14637': '24.10.31.000',  # –ø—Ä–æ–∫–∞—Ç —Ç–æ–ª—Å—Ç–æ–ª–∏—Å—Ç–æ–≤–æ–π (—É–≥–ª–µ—Ä–æ–¥–∏—Å—Ç–∞—è, ‚â•600 –º–º)
    '2590':  '24.10.62.121',  # –∫—Ä—É–≥ –≥–æ—Ä—è—á–µ–∫–∞—Ç–∞–Ω—ã–π (–Ω–µ–ª–µ–≥–∏—Ä.)
    '2591':  '24.10.62.122',  # –∫–≤–∞–¥—Ä–∞—Ç –≥–æ—Ä—è—á–µ–∫–∞—Ç–∞–Ω—ã–π (–Ω–µ–ª–µ–≥–∏—Ä.)
    '103':   '24.10.62.124',  # –ø–æ–ª–æ—Å–∞ —Å—Ç–∞–ª—å–Ω–∞—è (–Ω–µ–ª–µ–≥–∏—Ä., –≥–æ—Ä—è—á–µ–∫–∞—Ç–∞–Ω–∞—è)
    '7417':  '24.31.10.110',  # –∫—Ä—É–≥ –∫–∞–ª–∏–±—Ä–æ–≤–∞–Ω–Ω—ã–π (—Ö–æ–ª–æ–¥–Ω–æ—Ç—è–Ω—É—Ç—ã–π)
    '4986':  '24.32.10.000',  # –ª–µ–Ω—Ç–∞ —Å—Ç–∞–ª—å–Ω–∞—è —Ö/–∫ <600 –º–º (—à—Ç—Ä–∏–ø—Å)

    # –ø—Ä–∏–ø–æ–∏ –æ–ª–æ–≤—è–Ω–Ω–æ-—Å–≤–∏–Ω—Ü–æ–≤—ã–µ
    '21930': '24.43.24',      # —á—É—à–∫–∏ –ø—Ä–∏–ø–æ—è ‚Äî –¥–∞—ë–º –±–∞–∑—É, —Ñ–æ—Ä–º–∞ –Ω–µ —É—Ç–æ—á–Ω–µ–Ω–∞
    '21931': '24.43.24',      # –∏–∑–¥–µ–ª–∏—è –∏–∑ –ø—Ä–∏–ø–æ—è; –∫–æ–Ω–∫—Ä–µ—Ç–∏–∑–∏—Ä—É–µ–º –ø–æ —Ç–∏–ø—É –Ω–∏–∂–µ

    # —Ñ–∞—Å–æ–Ω–Ω—ã–π –ø—Ä–æ–∫–∞—Ç
    '8239':  '24.10.71.120',  # –¥–≤—É—Ç–∞–≤—Ä—ã
    '8240':  '24.10.71.130',  # —à–≤–µ–ª–ª–µ—Ä—ã
    '26020': '24.10.71.120',  # –¥–≤—É—Ç–∞–≤—Ä—ã —Å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–º–∏ –≥—Ä–∞–Ω—è–º–∏
    '8509':  '24.10.71.111',  # —É–≥–æ–ª–∫–∏ —Ä–∞–≤–Ω–æ–ø–æ–ª–æ—á–Ω—ã–µ
    '8510':  '24.10.71.112',  # —É–≥–æ–ª–∫–∏ –Ω–µ—Ä–∞–≤–Ω–æ–ø–æ–ª–æ—á–Ω—ã–µ

    # —Ç—Ä—É–±—ã —Å—Ç–∞–ª—å–Ω—ã–µ –±–µ—Å—à–æ–≤–Ω—ã–µ
    '8731':  '24.20.13.110',  # –¢–£ –Ω–∞ –≥–æ—Ä—è—á–µ–¥–µ—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
    '8732':  '24.20.13.110',  # —Å–æ—Ä—Ç–∞–º–µ–Ω—Ç –≥–æ—Ä—è—á–µ–¥–µ—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö
    '8733':  '24.20.13.140',  # –¢–£ –Ω–∞ —Ö–æ–ª–æ–¥–Ω–æ–¥–µ—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
    '8734':  '24.20.13.140',  # —Å–æ—Ä—Ç–∞–º–µ–Ω—Ç —Ö–æ–ª–æ–¥–Ω–æ–¥–µ—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö

    # –ê–õ–Æ–ú–ò–ù–ò–ô / –¶–í–ï–¢–ú–ï–¢
    '1535':  '24.44.22.110',  # –ø—Ä—É—Ç–∫–∏ –º–µ–¥–Ω—ã–µ (–ú1/–ú2/–ú3 –∏ –¥—Ä.)
    '17232': '24.42.24.110',  # –ø–ª–∏—Ç—ã/–ª–∏—Å—Ç—ã –∞–ª—é–º–∏–Ω–∏–µ–≤—ã–µ (>0,2 –º–º)
    '21631': '24.42.24.110',  # –ø–ª–∏—Ç—ã –∏–∑ –∞–ª—é–º–∏–Ω–∏–µ–≤—ã—Ö —Å–ø–ª–∞–≤–æ–≤
    '21488': '24.42.22.110',  # –ø—Ä—É—Ç–∫–∏ –∏–∑ –∞–ª—é–º–∏–Ω–∏—è/—Å–ø–ª–∞–≤–æ–≤
    '13737': '24.42.24.120',  # –ø–æ–ª–æ—Å—ã –∏ –ª–µ–Ω—Ç—ã –∞–ª—é–º–∏–Ω–∏–µ–≤—ã–µ (>0,2 –º–º)
    '13738': '24.42.22.130',  # –ø—Ä–æ—Ñ–∏–ª–∏ –∞–ª—é–º–∏–Ω–∏–µ–≤—ã–µ –ø—Ä–µ—Å—Å–æ–≤–∞–Ω–Ω—ã–µ
    '8617':  '24.42.22.130',  # –ø—Ä–æ—Ñ–∏–ª–∏ –ø—Ä–µ—Å—Å–æ–≤–∞–Ω–Ω—ã–µ (—É—Å—Ç—Ä–∞–Ω—ë–Ω –¥—É–±–ª–∏–∫–∞—Ç)
    '22233': '24.42.22.130',  # –ø—Ä–æ—Ñ–∏–ª–∏ –∏–∑ –∞–ª—é–º–∏–Ω–∏–µ–≤—ã—Ö —Å–ø–ª–∞–≤–æ–≤

    # === –ú–ï–î–¨/–õ–ê–¢–£–ù–¨ (—Å–ø–ª–∞–≤—ã –º–µ–¥–∏) ===
    '494':   '24.44.24.110',  # –ª–∏—Å—Ç—ã –ª–∞—Ç—É–Ω–Ω—ã–µ (–≤ –≥—Ä—É–ø–ø–µ ¬´–º–µ–¥—å¬ª ‚Äì –ø–æ–ª—É—Ñ–∞–±—Ä–∏–∫–∞—Ç—ã)
    '931':   '24.44.24.120',  # –ª–µ–Ω—Ç—ã –ª–∞—Ç—É–Ω–Ω—ã–µ (>0,15 –º–º)
    '2622':  '24.44.22.110',  # –ø—Ä—É—Ç–∫–∏ –ª–∞—Ç—É–Ω–Ω—ã–µ
    '859':   '24.44.13.120',  # –ª–∞—Ç—É–Ω—å –≤ —á—É—à–∫–∞—Ö (—Å–ø–ª–∞–≤—ã –º–µ–¥–Ω—ã–µ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ)
    '2060':  '24.44.13.120',  # –ª–∞—Ç—É–Ω—å –≤ —Å–ª–∏—Ç–∫–∞—Ö (—Å–ø–ª–∞–≤—ã –º–µ–¥–Ω—ã–µ –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ)

    # === –≠–õ–ï–ö–¢–†–û–ù–ò–ö–ê ===
    '10317': '26.12.10',      # –ø–ª–∞—Ç—ã –ø–µ—á–∞—Ç–Ω—ã–µ (—Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ) '26.12.10' ‚Äî —Ç—Ä–∞–∫—Ç—É–µ—Ç—Å—è –∫–∞–∫ —Ç–æ–≤–∞—Ä '26.12.91.120' ‚Äî —Ç—Ä–∞–∫—Ç—É–µ—Ç—Å—è –∫–∞–∫ —É—Å–ª—É–≥–∞ –ø–æ –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—é
    '10434': '27.33.13.120',  # —Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª–∏ —ç–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∏–µ (–∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è)

    # –≠–õ–ï–ö–¢–†–û–ò–ó–û–õ–Ø–¶–ò–Ø, –¢–ï–ö–°–¢–ò–õ–¨, –ë–£–ú–ê–ì–ê
    '16214': '27.33.14',      # –ª–µ–Ω—Ç–∞ –ü–í–• —ç–ª–µ–∫—Ç—Ä–æ–∏–∑–æ–ª—è—Ü–∏–æ–Ω–Ω–∞—è
    '13827': '13.95.10.110',  # –º–∞—Ç–µ—Ä–∏–∞–ª—ã –Ω–µ—Ç–∫–∞–Ω—ã–µ (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ; –µ—Å–ª–∏ –Ω—É–∂–Ω–æ ‚Äî —Å—É–∑–∏–º –¥–æ .111/.112)
    '3441':  '17.12.14.170',  # –±—É–º–∞–≥–∞ —ç–ª–µ–∫—Ç—Ä–æ–∏–∑–æ–ª—è—Ü–∏–æ–Ω–Ω–∞—è (–≠–ò–ü-50 –∏ –¥—Ä.)

    # –•–ò–ú–ò–Ø
    '4165':  '20.13.41.130',  # –º–µ–¥–Ω—ã–π –∫—É–ø–æ—Ä–æ—Å (—Å—É–ª—å—Ñ–∞—Ç—ã)
    '11159': '20.13.31.000',  # —Ö–ª–æ—Ä–Ω–æ–µ –∂–µ–ª–µ–∑–æ (–≥–∞–ª–æ–≥–µ–Ω–∏–¥—ã –º–µ—Ç–∞–ª–ª–æ–≤)

    # –î–ï–†–ï–í–û–û–ë–†–ê–ë–û–¢–ö–ê
    '24454': '16.10.10',      # –ø–∏–ª–æ–º–∞—Ç–µ—Ä–∏–∞–ª—ã —Ö–≤–æ–π–Ω—ã—Ö –ø–æ—Ä–æ–¥ (—Å–æ—Ä—Ç–∞–º–µ–Ω—Ç)
    '8486':  '16.10.10',      # –ø–∏–ª–æ–º–∞—Ç–µ—Ä–∏–∞–ª—ã —Ö–≤–æ–π–Ω—ã–µ ‚Äî —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–∞—á–µ—Å—Ç–≤—É (—Å–æ—Ä—Ç)    
}


# –ú–∞–ø–ø–∏–Ω–≥ DIN -> –û–ö–ü–î2
DIN2OKPD = {
    '912': '25.94.11.120',   # –≤–∏–Ω—Ç—ã —Å –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º —à–µ—Å—Ç–∏–≥—Ä–∞–Ω–Ω–∏–∫–æ–º
    '913': '25.94.11.120',   # –≤–∏–Ω—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–æ—á–Ω—ã–µ
    '933': '25.94.11.110',   # –±–æ–ª—Ç—ã —Å —à–µ—Å—Ç–∏–≥—Ä–∞–Ω–Ω–æ–π –≥–æ–ª–æ–≤–∫–æ–π
    '934': '25.94.11.130',   # –≥–∞–π–∫–∏ —à–µ—Å—Ç–∏–≥—Ä–∞–Ω–Ω—ã–µ
    '125': '25.94.12.110',   # —à–∞–π–±—ã –ø–ª–æ—Å–∫–∏–µ
    '127': '25.94.12.110',   # —à–∞–π–±—ã –ø—Ä—É–∂–∏–Ω–Ω—ã–µ
    '7980': '25.94.12.110',  # —à–∞–π–±—ã –ø—Ä—É–∂–∏–Ω–Ω—ã–µ —É—Å–∏–ª–µ–Ω–Ω—ã–µ
    '7989': '25.94.12.110',  # —à–∞–π–±—ã –ø—Ä—É–∂–∏–Ω–Ω—ã–µ —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–µ (–¥–ª—è —Ç–æ–ª—Å—Ç—ã—Ö –¥–µ—Ç–∞–ª–µ–π)
}

# –ú–∞–ø–ø–∏–Ω–≥ ISO -> –û–ö–ü–î2  
ISO2OKPD = {
    '2010': '25.94.11.120',  # ISO 2010 ‚Äî –≤–∏–Ω—Ç—ã —Å –ø–æ–ª—É–ø–æ—Ç–∞–π–Ω–æ–π –≥–æ–ª–æ–≤–∫–æ–π
    '4014': '25.94.11.110',  # –±–æ–ª—Ç—ã —Å —à–µ—Å—Ç–∏–≥—Ä–∞–Ω–Ω–æ–π –≥–æ–ª–æ–≤–∫–æ–π
    '4017': '25.94.11.110',  # –±–æ–ª—Ç—ã —Å —à–µ—Å—Ç–∏–≥—Ä–∞–Ω–Ω–æ–π –≥–æ–ª–æ–≤–∫–æ–π
    '4018': '25.94.11.120',  # –≤–∏–Ω—Ç—ã —Å —à–µ—Å—Ç–∏–≥—Ä–∞–Ω–Ω–æ–π –≥–æ–ª–æ–≤–∫–æ–π
    '4032': '25.94.11.130',  # –≥–∞–π–∫–∏ —à–µ—Å—Ç–∏–≥—Ä–∞–Ω–Ω—ã–µ
    '7089': '25.94.12.110',  # —à–∞–π–±—ã –ø–ª–æ—Å–∫–∏–µ
    '7090': '25.94.12.110',  # —à–∞–π–±—ã –ø–ª–æ—Å–∫–∏–µ —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–µ
}


AL_CTX = r'(?i:\b(?:EN\s*AW|AA|Al(?:uminium|uminum)?|–ê–õ–Æ–ú–ò–ù–ò–ô)\s*[-/]?\s*)' # –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π ¬´–º–∞—Ä–∫–µ—Ä –∞–ª—é–º–∏–Ω–∏—è¬ª (EN/US/ru), + —Ç–µ–º–ø–µ—Ä—ã (T/H) –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
AL_NUMS = r'(1050A|1100|3003|3004|5083|5086|5754|6060|6061|6063|6082|7075)' # –ù–æ–º–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ø—É—Å–∫–∞–µ–º –¢–û–õ–¨–ö–û –ø–æ—Å–ª–µ –º–∞—Ä–∫–µ—Ä–∞
CU_CTX = r'(?i:(?:–º–µ–¥—å|cu))' # –ö–æ–Ω—Ç–µ–∫—Å—Ç –º–µ–¥–∏

# –ú–∞—Ä–∫–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ -> –û–ö–ü–î2
MATERIAL_GRADES = {
    # ‚Äî‚Äî‚Äî –î–û–ü–û–õ–ù–ï–ù–ò–Ø –ö –°–¢–ê–õ–Ø–ú –ö–û–ù–°–¢–†–£–ö–¶–ò–û–ù–ù–´–ú/–ü–†–£–ñ–ò–ù–ù–´–ú/–ü–û–î–®–ò–ü–ù–ò–ö–û–í–´–ú ‚Äî‚Äî‚Äî
    r'\b17–ì1–°(–£)?\b'         : ('24.10.32', '—Å—Ç–∞–ª—å 17–ì1–°/17–ì1–°–£'),
    r'\b10–•–°–ù–î\b|\b15–•–°–ù–î\b' : ('24.10.32', '—Å—Ç–∞–ª—å –∞—Ç–º–æ—Å—Ñ–µ—Ä–æ—Å—Ç–æ–π–∫–∞—è 10–•–°–ù–î/15–•–°–ù–î'),
    r'\b70–ì\b'               : ('24.10.32', '—Å—Ç–∞–ª—å –ø—Ä—É–∂–∏–Ω–Ω–∞—è 70–ì'),
    r'\b55–°2\b'              : ('24.10.32', '—Å—Ç–∞–ª—å –ø—Ä—É–∂–∏–Ω–Ω–∞—è 55–°2'),
    r'\b–®–•15–°–ì?\b'           : ('24.10.32', '—Å—Ç–∞–ª—å –ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤–∞—è –®–•15–°–ì'),
    r'\b100Cr6\b'            : ('24.10.32', '–ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤–∞—è —Å—Ç–∞–ª—å 100Cr6 (‚âà–®–•15)'),
    r'\b52100\b'             : ('24.10.32', '–ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤–∞—è —Å—Ç–∞–ª—å AISI 52100'),
 
    # ‚Äî‚Äî‚Äî –ñ–ê–†–û–ü–†–û–ß–ù–´–ï / Ni-–°–ü–õ–ê–í–´ (fallback –ø–æ –º–∞—Ä–∫–µ) ‚Äî‚Äî‚Äî
    r'(?i)\b–•–ù60–Æ\b|\b–•–ù65–ú–í\b|\b–•–ù73–ú–ë–¢–Æ\b'   : ('24.45',  '–∂–∞—Ä–æ–ø—Ä–æ—á–Ω—ã–π –Ω–∏–∫–µ–ª–µ–≤—ã–π —Å–ø–ª–∞–≤'),
    r'(?i)\b–•–ù70–í–ú–¢–Æ\b'                        : ('24.45',  '–∂–∞—Ä–æ–ø—Ä–æ—á–Ω—ã–π –Ω–∏–∫–µ–ª–µ–≤—ã–π —Å–ø–ª–∞–≤ –•–ù70–í–ú–¢–Æ'),
    r'(?i)\b–•–ù50–í–ú–¢–Æ–ë\b'                       : ('24.45',  '–∂–∞—Ä–æ–ø—Ä–æ—á–Ω—ã–π –Ω–∏–∫–µ–ª–µ–≤—ã–π —Å–ø–ª–∞–≤ –•–ù50–í–ú–¢–Æ–ë'),
    r'(?i)\b–•–ù77–¢–Æ–†\b'                         : ('24.45',  '–∂–∞—Ä–æ–ø—Ä–æ—á–Ω—ã–π –Ω–∏–∫–µ–ª–µ–≤—ã–π —Å–ø–ª–∞–≤ –•–ù77–¢–Æ–†'),
    r'(?i)\b–•–ù35–í–¢–Æ\b'                         : ('24.45',  '–∂–∞—Ä–æ–ø—Ä–æ—á–Ω—ã–π –Ω–∏–∫–µ–ª–µ–≤—ã–π —Å–ø–ª–∞–≤ –•–ù35–í–¢–Æ'),
    r'(?i)\b–≠–ò\d{3}\b'                         : ('24.45',  '–∂–∞—Ä–æ–ø—Ä–æ—á–Ω—ã–π —Å–ø–ª–∞–≤ —Å–µ—Ä–∏–∏ –≠–ò'),
    r'(?i)\b–≠–ü\d{3}\b'                         : ('24.45',  '–∂–∞—Ä–æ–ø—Ä–æ—á–Ω—ã–π —Å–ø–ª–∞–≤ —Å–µ—Ä–∏–∏ –≠–ü'),
    r'(?i)\bInconel\s*(625|718|600)\b'         : ('24.45',  'Inconel \\1'),
    r'(?i)\bHastelloy\s*(C-?276|C22)\b'        : ('24.45',  'Hastelloy \\1'),
    r'(?i)\bMonel\s*400\b'                     : ('24.45',  'Monel 400'),
    
    # ‚Äî‚Äî‚Äî –¢–ò–¢–ê–ù: –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –¥–æ–±–∏–≤–∫–∏ ‚Äî‚Äî‚Äî
    r'\b–í–¢5-1\b'             : ('24.45.30', '—Ç–∏—Ç–∞–Ω–æ–≤—ã–π —Å–ø–ª–∞–≤ –í–¢5-1'),
    r'\b–í–¢6\b'               : ('24.45.30', '—Ç–∏—Ç–∞–Ω–æ–≤—ã–π —Å–ø–ª–∞–≤ –í–¢6'),
    r'\b–í–¢9\b'               : ('24.45.30', '—Ç–∏—Ç–∞–Ω–æ–≤—ã–π —Å–ø–ª–∞–≤ –í–¢9'),
    r'\b–í–¢14\b'              : ('24.45.30', '—Ç–∏—Ç–∞–Ω–æ–≤—ã–π —Å–ø–ª–∞–≤ –í–¢14'),
    r'\b–í–¢16\b'              : ('24.45.30', '—Ç–∏—Ç–∞–Ω–æ–≤—ã–π —Å–ø–ª–∞–≤ –í–¢16'),
    r'\b–ü–¢7–ú\b'              : ('24.45.30', '—Ç–∏—Ç–∞–Ω–æ–≤—ã–π —Å–ø–ª–∞–≤ –ü–¢7–ú'),

    # ‚Äî‚Äî‚Äî –õ–ê–¢–£–ù–ò/–ë–†–û–ù–ó–´: –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏ –∏ EN ‚Äî‚Äî‚Äî
    r'\b–õ–°59-1\b'            : ('24.44', '–ª–∞—Ç—É–Ω—å –õ–°59-1'),
    r'\bCW(614N|508L|612N)\b' : ('24.44', '–ª–∞—Ç—É–Ω—å EN CW\\1'),
    r'\bCuZn(37|39Pb3)\b'    : ('24.44', '–ª–∞—Ç—É–Ω—å CuZn\\1'),
    r'\b–ë—Ä–û10–§1\b|\b–ë—Ä–û–¶–°5-5-5\b|\b–ë—Ä–ê–ñ9-4\b|\b–ë—Ä–ê–ñ–ú—Ü10-3-1\.5\b' : ('24.44', '–±—Ä–æ–Ω–∑–∞ –¥–µ—Ñ–æ—Ä–º–∏—Ä—É–µ–º–∞—è'),

    # ‚Äî‚Äî‚Äî –°–í–ê–†–û–ß–ù–´–ï –ú–ê–†–ö–ï–†–´ (–¥–ª—è –ø—Ä–æ–≤–æ–ª–æ–∫–∏) ‚Äî‚Äî‚Äî
    r'\b–°–≤-?08–ì2–°\b'         : ('24.34.13.120', '–ø—Ä–æ–≤–æ–ª–æ–∫–∞ —Å–≤–∞—Ä–æ—á–Ω–∞—è –°–≤-08–ì2–°'),
    # ‚Äî‚Äî‚Äî –°–¢–ê–õ–ò –õ–ï–ì–ò–†–û–í–ê–ù–ù–´–ï / –ù–ò–ó–ö–û–õ–ï–ì–ò–†–û–í–ê–ù–ù–´–ï / –ü–†–£–ñ–ò–ù–ù–´–ï / –ü–û–î–®–ò–ü–ù–ò–ö–û–í–´–ï ‚Äî‚Äî‚Äî
    r'\b09–ì2–°\b'          : ('24.10.32', '—Å—Ç–∞–ª—å –Ω–∏–∑–∫–æ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è 09–ì2–°'),
    r'\b09G2S\b'          : ('24.10.32', '—Å—Ç–∞–ª—å –Ω–∏–∑–∫–æ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è 09G2S'),
    r'\b65–ì\b'            : ('24.10.32', '—Å—Ç–∞–ª—å –ø—Ä—É–∂–∏–Ω–Ω–∞—è 65–ì'),
    r'\b60–°2–ê\b'          : ('24.10.32', '—Å—Ç–∞–ª—å –ø—Ä—É–∂–∏–Ω–Ω–∞—è 60–°2–ê'),
    r'\b–®–•15\b'           : ('24.10.32', '—Å—Ç–∞–ª—å –ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤–∞—è –®–•15'),
    r'\b18–•–ì–¢\b'          : ('24.10.32', '—Å—Ç–∞–ª—å –ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è 18–•–ì–¢'),
    r'\b12–•–ù3–ê\b'         : ('24.10.32', '—Å—Ç–∞–ª—å –ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è 12–•–ù3–ê'),
    r'\b20–•–ù3–ê\b'         : ('24.10.32', '—Å—Ç–∞–ª—å –ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è 20–•–ù3–ê'),
    r'\b38–•2–ú–Æ–ê\b'        : ('24.10.32', '—Å—Ç–∞–ª—å –ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è 38–•2–ú–Æ–ê'),
    r'\b40–•–ì\b'           : ('24.10.32', '—Å—Ç–∞–ª—å –ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è 40–•–ì'),
    r'\b(?:—Å—Ç–∞–ª—å\s*)?40–•': ('24.10.32', '—Å—Ç–∞–ª—å –ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è 40–•'),
    r'\b(?:—Å—Ç–∞–ª—å\s*)?45–•': ('24.10.32', '—Å—Ç–∞–ª—å –ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è 45–•'),
    r'\b(?:—Å—Ç–∞–ª—å\s*)?30–•–ì–°–ê': ('24.10.32', '—Å—Ç–∞–ª—å –ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è 30–•–ì–°–ê'),
    r'\b(?:—Å—Ç–∞–ª—å\s*)?40–•–ù': ('24.10.32', '—Å—Ç–∞–ª—å –ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è 40–•–ù'),
    r'(?i)\b30[–•X]2[–ùNH]2[–íVB][–§F][–úM][–êA]\b' : ('24.10.32', '—Å—Ç–∞–ª—å –≤—ã—Å–æ–∫–æ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è 30–•2–ù2–í–§–ú–ê'),
    r'\b38–•–ù3–ú–ê\b'           : ('24.10.32', '—Å—Ç–∞–ª—å –ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è 38–•–ù3–ú–ê'),
    r'\b40–•–ù2–ú–ê\b'           : ('24.10.32', '—Å—Ç–∞–ª—å –ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è 40–•–ù2–ú–ê'),
    r'\b40–•–ù–ú–ê\b'            : ('24.10.32', '—Å—Ç–∞–ª—å –ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è 40–•–ù–ú–ê'),

    # ‚Äî‚Äî‚Äî –¢–ò–¢–ê–ù (—Å –¥–µ—Ñ–∏—Å–∞–º–∏ –∏ –Ω–æ–≤—ã–µ –∏–Ω–¥–µ–∫—Å—ã) ‚Äî‚Äî‚Äî
    r'\b–í–¢1(?:-0)?\b'     : ('24.45.30', '—Ç–∏—Ç–∞–Ω —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –í–¢1-0'),
    r'\b–í–¢3-1\b'          : ('24.45.30', '—Ç–∏—Ç–∞–Ω–æ–≤—ã–π —Å–ø–ª–∞–≤ –í–¢3-1'),
    r'\b–í–¢22\b'           : ('24.45.30', '—Ç–∏—Ç–∞–Ω–æ–≤—ã–π —Å–ø–ª–∞–≤ –í–¢22'),
    r'\b–í–¢23\b'           : ('24.45.30', '—Ç–∏—Ç–∞–Ω–æ–≤—ã–π —Å–ø–ª–∞–≤ –í–¢23'),
    r'\b–û–¢4-1\b'          : ('24.45.30', '—Ç–∏—Ç–∞–Ω–æ–≤—ã–π —Å–ø–ª–∞–≤ –û–¢4-1'),

    # ‚Äî‚Äî‚Äî –õ–ê–¢–£–ù–ò / –ë–†–û–ù–ó–´ (–¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è) ‚Äî‚Äî‚Äî
    r'\b–õ–°58-2\b'                              : ('24.44',    '–ª–∞—Ç—É–Ω—å —Å–≤–∏–Ω—Ü–æ–≤–∞—è –õ–°58-2'),
    r'\b–ë—Ä–ë[12]\b'                             : ('24.44.21', '–±—Ä–æ–Ω–∑–∞ –±–µ—Ä–∏–ª–ª–∏–µ–≤–∞—è –ë—Ä–ë'),
    r'\b–ë—Ä–ö–ú—Ü[0-9\-]+'                         : ('24.44.21', '–±—Ä–æ–Ω–∑–∞ –∫—Ä–µ–º–Ω–∏—Å—Ç–æ-–º–∞—Ä–≥–∞–Ω—Ü–µ–≤–∞—è'),

    # === –°–¢–ê–õ–ò –£–ì–õ–ï–†–û–î–ò–°–¢–´–ï ===
    r'\b–°—Ç\.?\s*0': ('24.10.61', '—Å—Ç–∞–ª—å —É–≥–ª–µ—Ä–æ–¥–∏—Å—Ç–∞—è –°—Ç0'),
    r'\b–°—Ç\.?\s*3(?:—Å–ø|–ø—Å|–∫–ø)?': ('24.10.61', '—Å—Ç–∞–ª—å —É–≥–ª–µ—Ä–æ–¥–∏—Å—Ç–∞—è –°—Ç3'),
    r'\b–°—Ç\.?\s*4(?:—Å–ø|–ø—Å|–∫–ø)?': ('24.10.61', '—Å—Ç–∞–ª—å —É–≥–ª–µ—Ä–æ–¥–∏—Å—Ç–∞—è –°—Ç4'),
    r'\b–°—Ç\.?\s*5(?:—Å–ø|–ø—Å|–∫–ø)?': ('24.10.61', '—Å—Ç–∞–ª—å —É–≥–ª–µ—Ä–æ–¥–∏—Å—Ç–∞—è –°—Ç5'),
    r'\b(?:—Å—Ç–∞–ª—å\s*)?(?:10|15|20|25|30|35|40|45|50|55|60|65|70)\b': ('24.10.62', '—Å—Ç–∞–ª—å —É–≥–ª–µ—Ä–æ–¥–∏—Å—Ç–∞—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è'),

    # === –ù–ï–†–ñ–ê–í–ï–Æ–©–ò–ï –°–¢–ê–õ–ò ===
    r'\b12–•18–ù10–¢': ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 12–•18–ù10–¢'),
    r'\b12–•18–ù9–¢': ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 12–•18–ù9–¢'),
    r'\b08–•18–ù10': ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 08–•18–ù10'),
    r'\b08–•18–ù10–¢': ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 08–•18–ù10–¢'),
    r'\b10–•17–ù13–ú2–¢': ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 10–•17–ù13–ú2–¢'),
    r'\b07–•16–ù6': ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 07–•16–ù6'),
    r'\b20–•13': ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 20–•13'),
    r'\b30–•13': ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 30–•13'),
    r'\b40–•13': ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 40–•13'),
    r'\b95–•18': ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 95–•18'),
    r'\b07–•12–ù–ú–ë–§': ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 07–•12–ù–ú–ë–§'),
    r'(?i)\b(12–•18–ù10–¢|12–•18–ù9–¢|08–•18–ù10–¢?|10–•17–ù13–ú2–¢|07–•16–ù6|20–•13|30–•13|40–•13|95–•18|07–•12–ù–ú–ë–§|12–•17|08–•17|14–•17–ù2)\b'
        : ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è \\1'),
    r'(?i)\b(12X18H10T|08X18H10|10X17H13M2T)\b'
        : ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è \\1'),
    
    # ‚Äî‚Äî‚Äî –ù–ï–†–ñ–ê–í–ï–Æ–©–ò–ï: –§–ï–†–†–ò–¢/–ú–ê–†–¢–ï–ù–°–ò–¢/PH/–î–Æ–ü–õ–ï–ö–° ‚Äî‚Äî‚Äî
    r'(?i)\bAISI\s*430\b'        : ('24.10.22', '–Ω–µ—Ä–∂. —Å—Ç–∞–ª—å AISI 430'),
    r'(?i)\bAISI\s*409\b'        : ('24.10.22', '–Ω–µ—Ä–∂. —Å—Ç–∞–ª—å AISI 409'),
    r'(?i)\bAISI\s*410\b'        : ('24.10.22', '–Ω–µ—Ä–∂. —Å—Ç–∞–ª—å AISI 410'),
    r'(?i)\bAISI\s*420\b'        : ('24.10.22', '–Ω–µ—Ä–∂. —Å—Ç–∞–ª—å AISI 420'),
    r'(?i)\bAISI\s*904L\b'       : ('24.10.22', '–Ω–µ—Ä–∂. —Å—Ç–∞–ª—å AISI 904L'),
    r'(?i)\b17[- ]?4\s*PH\b|\bAISI\s*630\b' : ('24.10.22', '–Ω–µ—Ä–∂. —Å—Ç–∞—Ä–µ—é—â–∞—è 17-4PH (AISI 630)'),
    r'(?i)\b15[- ]?5\s*PH\b'     : ('24.10.22', '–Ω–µ—Ä–∂. —Å—Ç–∞—Ä–µ—é—â–∞—è 15-5PH'),
    r'(?i)\b1\.(4571|4462|4410)\b': ('24.10.22', '–Ω–µ—Ä–∂–∞–≤–µ—é—â–∞—è —Å—Ç–∞–ª—å EN 1.\\1'),
    r'(?i)\bduplex\b|\bsuper\s*duplex\b'    : ('24.10.22', '–Ω–µ—Ä–∂–∞–≤–µ—é—â–∞—è Duplex'),
    r'(?i)\bX\dCrNi\d{2}-\d{1,2}\b': ('24.10.22', '–Ω–µ—Ä–∂. –ø–æ EN (X‚Ä¶CrNi‚Ä¶)'),

    # –ì–û–°–¢/—Ä—É—Å—Å–∫–∏–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω–∏—è (–∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∏–µ), —Ç–æ–∂–µ –∫–∞–∫ fallback:
    r'(?i)\b12–•18–ù10–¢\b' : ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 12–•18–ù10–¢'),
    r'(?i)\b12–•18–ù9–¢\b'  : ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 12–•18–ù9–¢'),
    r'(?i)\b08–•18–ù10\b'  : ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 08–•18–ù10'),
    r'(?i)\b08–•18–ù10–¢\b' : ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 08–•18–ù10–¢'),
    r'(?i)\b10–•17–ù13–ú2–¢\b': ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 10–•17–ù13–ú2–¢'),
    r'(?i)\b07–•16–ù6\b'   : ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 07–•16–ù6'),
    r'(?i)\b20–•13\b'     : ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 20–•13'),
    r'(?i)\b30–•13\b'     : ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 30–•13'),
    r'(?i)\b40–•13\b'     : ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 40–•13'),
    r'(?i)\b95–•18\b'     : ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 95–•18'),
    r'(?i)\b07–•12–ù–ú–ë–§\b' : ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 07–•12–ù–ú–ë–§'),
    r'(?i)\b12–•17\b'     : ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 12–•17'),
    r'(?i)\b08–•17\b'     : ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 08–•17'),
    r'(?i)\b14–•17–ù2\b'   : ('24.10.22', '—Å—Ç–∞–ª—å –∫–æ—Ä—Ä–æ–∑–∏–æ–Ω–Ω–æ—Å—Ç–æ–π–∫–∞—è 14–•17–ù2'),

    # –õ–∞—Ç–∏–Ω–∏—Ü–∞ –ì–û–°–¢-–º–∞—Ä–æ–∫
    r'(?i)\b12X18H10T\b' : ('24.10.22', '12–•18–ù10–¢ (–ª–∞—Ç.)'),
    r'(?i)\b08X18H10\b'  : ('24.10.22', '08–•18–ù10 (–ª–∞—Ç.)'),
    r'(?i)\b10X17H13M2T\b': ('24.10.22', '10–•17–ù13–ú2–¢ (–ª–∞—Ç.)'),

    # AISI —Ç–∏–ø–æ–≤—ã–µ (–≤ —Ç.—á. –∫—Ä–µ–ø—ë–∂–Ω—ã–µ –∫–ª–∞—Å—Å—ã A2/A4 –∫–∞–∫ –º–∞—Ä–∫–µ—Ä—ã —Å–µ–º–µ–π—Å—Ç–≤–∞)
    r'(?i)\bAISI\s*304(L)?\b' : ('24.10.22', 'AISI 304/304L'),
    r'(?i)\bAISI\s*316(L)?\b' : ('24.10.22', 'AISI 316/316L'),
    r'(?i)\bAISI\s*321\b'     : ('24.10.22', 'AISI 321'),
    r'(?i)\bA[24][- ]?\d{2}\b': ('24.10.22', '–∫–ª–∞—Å—Å A2/A4 (‚âà304/316)'),
    r'(?i)\b1\.(4301|4307|4541|4401|4404|4016)\b' : ('24.10.22', '–Ω–µ—Ä–∂. –ø–æ EN'),

    # === –ò–ù–°–¢–†–£–ú–ï–ù–¢–ê–õ–¨–ù–´–ï –°–¢–ê–õ–ò ===
    r'\b–£7–ê?': ('24.10.36', '—Å—Ç–∞–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –£7'),
    r'\b–£8–ê?': ('24.10.36', '—Å—Ç–∞–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –£8'),
    r'\b–£10–ê?': ('24.10.36', '—Å—Ç–∞–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –£10'),
    r'\b–£12–ê?': ('24.10.36', '—Å—Ç–∞–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –£12'),
    r'\b–•–í–ì': ('24.10.36', '—Å—Ç–∞–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –•–í–ì'),
    r'\b–•12–ú': ('24.10.36', '—Å—Ç–∞–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –•12–ú'),
    r'\b–•12–ú–§': ('24.10.36', '—Å—Ç–∞–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –•12–ú–§'),
    r'\b–•12–§1': ('24.10.36', '—Å—Ç–∞–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –•12–§1'),
    r'\b9–•–°': ('24.10.36', '—Å—Ç–∞–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è 9–•–°'),
    r'\b6–•–í2–°': ('24.10.36', '—Å—Ç–∞–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è 6–•–í2–°'),
    r'\b–†6–ú5': ('24.10.36', '—Å—Ç–∞–ª—å –±—ã—Å—Ç—Ä–æ—Ä–µ–∂—É—â–∞—è –†6–ú5'),
    r'\b–†18': ('24.10.36', '—Å—Ç–∞–ª—å –±—ã—Å—Ç—Ä–æ—Ä–µ–∂—É—â–∞—è –†18'),
 
    # === –ê–õ–Æ–ú–ò–ù–ò–ï–í–´–ï –°–ü–õ–ê–í–´ ===
    r'(?i)\b–ê–ú—Ü\b'                                 : ('24.42', '–∞–ª—é–º–∏–Ω–∏–µ–≤—ã–π —Å–ø–ª–∞–≤ –ê–ú—Ü'),
    r'(?i)\b1561[–ë–ú]?\b'                           : ('24.42', '–∞–ª—é–º–∏–Ω–∏–µ–≤—ã–π —Å–ø–ª–∞–≤ 1561'),
    r'(?i)\b1163[–ê–¢]?\b'                           : ('24.42', '–∞–ª—é–º–∏–Ω–∏–µ–≤—ã–π —Å–ø–ª–∞–≤ 1163'),
    r'(?i)\b–í95(?:–ø—á)?(?:[-\s]?–¢[1-3])?\b'         : ('24.42', '–∞–ª—é–º–∏–Ω–∏–µ–≤—ã–π —Å–ø–ª–∞–≤ –í95'),
    r'(?i)\b–î1(?:[–ê–¢])?\b'                         : ('24.42', '–∞–ª—é–º–∏–Ω–∏–µ–≤—ã–π —Å–ø–ª–∞–≤ –î1'),
    r'(?i)\b–ê–ö[47](?:—á)?(?:-1)?\b'                 : ('24.42', '–∞–ª—é–º–∏–Ω–∏–µ–≤—ã–π —Å–ø–ª–∞–≤ –ê–ö'),
    r'(?i)\b–ê–î0\b'                                 : ('24.42', '–∞–ª—é–º–∏–Ω–∏–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ê–î0'),
    r'(?i)\b–ê–î1\b'                                 : ('24.42', '–∞–ª—é–º–∏–Ω–∏–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –ê–î1'),
    r'(?i)\b–ê–î31\b'                                : ('24.42', '–∞–ª—é–º–∏–Ω–∏–µ–≤—ã–π —Å–ø–ª–∞–≤ –ê–î31'),
    rf'{AL_CTX}{AL_NUMS}\b(?:[-\s]?(?:T|H)\d\w*)?' : ('24.42', '–∞–ª—é–º–∏–Ω–∏–µ–≤—ã–π —Å–ø–ª–∞–≤ (EN/AA/Al)'),
    r'(?i)\bEN\s*AW[- ]?(2024|2017A|1100|3004|5086)(?:[-\s]?[HT]\d\w*)?\b'
                                                    : ('24.42', '–∞–ª—é–º–∏–Ω–∏–µ–≤—ã–π —Å–ø–ª–∞–≤ EN AW-\\1'),
    r'(?i)\b–ê–ú–≥[23456]–ú?\b'                        : ('24.42', '–∞–ª—é–º–∏–Ω–∏–µ–≤—ã–π —Å–ø–ª–∞–≤ –ê–ú–≥'),
    r'(?i)\b–î16(?:[–ê–¢])?\b'                        : ('24.42', '–∞–ª—é–º–∏–Ω–∏–µ–≤—ã–π —Å–ø–ª–∞–≤ –î16'),
    r'(?i)\b–ê–î3[135]\b'                            : ('24.42', '–∞–ª—é–º–∏–Ω–∏–µ–≤—ã–π —Å–ø–ª–∞–≤ –ê–î31/–ê–î33/–ê–î35'),

    # === –ú–ï–î–ù–´–ï –°–ü–õ–ê–í–´ ===
    r'\b–õ–∞—Ç—É–Ω—å': ('24.44', '–ª–∞—Ç—É–Ω—å'),
    r'\b–õ(?:63|68|70)\b': ('24.44', '–ª–∞—Ç—É–Ω—å'),
    r'\b–õ–°59': ('24.44.13', '–ª–∞—Ç—É–Ω—å –õ–°59'),
    r'\b–ë—Ä–ê–ñ': ('24.44.21', '–±—Ä–æ–Ω–∑–∞ –∞–ª—é–º–∏–Ω–∏–µ–≤–æ-–∂–µ–ª–µ–∑–Ω–∞—è'),
    r'\b–ë—Ä–û–§': ('24.44.21', '–±—Ä–æ–Ω–∑–∞ –æ–ª–æ–≤—è–Ω–Ω–æ-—Ñ–æ—Å—Ñ–æ—Ä–∏—Å—Ç–∞—è'),
    r'\b–ë—Ä–û–¶–°': ('24.44.21', '–±—Ä–æ–Ω–∑–∞ –æ–ª–æ–≤—è–Ω–Ω–æ-—Ü–∏–Ω–∫–æ–≤–æ-—Å–≤–∏–Ω—Ü–æ–≤–∞—è'),
    rf'(?i)(?:{CU_CTX}\s*[:\-]?\s*[m–º][123]\b|\b[m–º][123]\b\s*(?:{CU_CTX})|\b–º–∞—Ä–∫–∞\s*[m–º][123]\b)' : ('24.44', '–º–µ–¥—å (–ú1/–ú2/–ú3)'),
        
    # === –¢–ò–¢–ê–ù–û–í–´–ï –°–ü–õ–ê–í–´ ===
    r'\b–í–¢[156]\b': ('24.45.30', '—Ç–∏—Ç–∞–Ω–æ–≤—ã–π —Å–ø–ª–∞–≤ –í–¢'),
    r'\b–í–¢20': ('24.45.30', '—Ç–∏—Ç–∞–Ω–æ–≤—ã–π —Å–ø–ª–∞–≤ –í–¢20'),
    r'\b–û–¢4': ('24.45.30', '—Ç–∏—Ç–∞–Ω–æ–≤—ã–π —Å–ø–ª–∞–≤ –û–¢4'),
    r'\b–ü–¢(?:7–ú|-\d+)?\b': ('24.45.30', '—Ç–∏—Ç–∞–Ω–æ–≤—ã–π —Å–ø–ª–∞–≤ –ü–¢'),
}

# –°–µ–º–µ–π—Å—Ç–≤–∞ –∏–∑–¥–µ–ª–∏–π
FAMILY = [

    # === –ø—Ä–∏–ø–æ–π ===
    (re.compile(r'\b–ø—Ä–∏–ø–æ[–π—è]\b|\b–ü–û–°[–ö–°]?(?:[-\s]?\d{2}(?:-\d{1,2})?)?\b', re.I), '24.43.24'),

    # ‚öôÔ∏è === –ö–†–ï–ü–Å–ñ (–¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π) ===
    (re.compile(r'\b–±–æ–ª—Ç\w*\s*–ú\d+', re.I), '25.94.11.110'),
    (re.compile(r'\b–≤–∏–Ω—Ç\w*\s*–ú\d+', re.I), '25.94.11.120'),
    (re.compile(r'\b–≥–∞–π–∫[–∞–∏]\w*\s*–ú\d+', re.I), '25.94.11.130'),
    (re.compile(r'\b—à–∞–π–±[–∞—ã]\w*(?:\s*(?:[–ê–ú]?\d+|8[,\.]4|10[,\.]5))?', re.I), '25.94.12.110'),
    (re.compile(r'\b—à—Ç–∏—Ñ—Ç\w*', re.I), '25.94.12.190'),
    (re.compile(r'\b–∑–∞–∫–ª–µ–ø\w*', re.I), '25.94.12.120'),
    (re.compile(r'\b—à–ø–∏–ª—å–∫\w*', re.I), '25.94.11.140'),
    (re.compile(r'\b—à–ø–ª–∏–Ω—Ç\w*', re.I), '25.94.12.140'),
    (re.compile(r'\b–∫–æ–ª—å—Ü[–∞–æ]\s+—Å—Ç–æ–ø–æ—Ä–Ω', re.I), '25.94.12.150'),
    
    # === –ú–ï–¢–ê–õ–õ–û–ü–†–û–ö–ê–¢ (–æ—Å—Ç–æ—Ä–æ–∂–Ω—ã–µ —ç–≤—Ä–∏—Å—Ç–∏–∫–∏; –ø–æ—Ä—è–¥–æ–∫ —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑ –≤–∞–∂–µ–Ω) ===

    # ‚Äî –ù–µ–∑–∞–º–∫–Ω—É—Ç—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏ (—É–≥–æ–ª–∫–∏, –¥–≤—É—Ç–∞–≤—Ä—ã, —à–≤–µ–ª–ª–µ—Ä—ã, –±–∞–ª–∫–∏) ‚Äî
    (re.compile(r'\b—É–≥–æ–ª–æ–∫\b', re.I),              '24.10.71.110'),  # —É–≥–æ–ª–∫–∏, –Ω–µ–ª–µ–≥–∏—Ä. —Å—Ç–∞–ª—å
    (re.compile(r'\b(–¥–≤—É—Ç–∞–≤—Ä|–±–∞–ª–∫[–∞–∏])\b', re.I),  '24.10.71.120'),  # –¥–≤—É—Ç–∞–≤—Ä—ã/–±–∞–ª–∫–∏, –Ω–µ–ª–µ–≥–∏—Ä. —Å—Ç–∞–ª—å
    (re.compile(r'\b—à–≤–µ–ª–ª–µ—Ä\b', re.I),             '24.10.71.130'),  # —à–≤–µ–ª–ª–µ—Ä—ã, –Ω–µ–ª–µ–≥–∏—Ä. —Å—Ç–∞–ª—å

    # ‚Äî –ö—Ä—É–≥ / –ø—Ä—É—Ç–æ–∫ ‚Äî
    (re.compile(r'\b(–∫—Ä—É–≥|–ø—Ä—É—Ç–æ–∫)\s*(–≥/–∫|–≥–æ—Ä—è—á\w*)\b', re.I), '24.10.62.121'),   # –∫—Ä—É–≥ –≥/–∫ (–≥–æ—Ä—è—á–µ–∫–∞—Ç–∞–Ω—ã–π)
    (re.compile(r'\b(–∫—Ä—É–≥|–ø—Ä—É—Ç–æ–∫)\s*(–∫/–∫|–∫–∞–ª–∏–±—Ä–æ–≤–∞–Ω–Ω\w*|—Ö/—Ç|—Ö–æ–ª–æ–¥–Ω–æ—Ç—è–Ω\w*)\b', re.I), '24.31.10.110'),  # –ø—Ä—É—Ç–∫–∏/–∫—Ä—É–≥–∏ –∫–∞–ª–∏–±—Ä–æ–≤–∞–Ω–Ω—ã–µ (—Ö/—Ç)
    # –ï—Å–ª–∏ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–æ "–∫—Ä—É–≥"/"–ø—Ä—É—Ç–æ–∫" –±–µ–∑ —É—Ç–æ—á–Ω–µ–Ω–∏–π ‚Äî –ª—É—á—à–µ –Ω–µ –º–∞–ø–ø–∏—Ç—å –∏–ª–∏ –º–∞–ø–ø–∏—Ç—å —à–∏—Ä–µ:
    # (re.compile(r'\b(–∫—Ä—É–≥|–ø—Ä—É—Ç–æ–∫)\b', re.I), '24.10.62')  # –≤–∫–ª—é—á–∞—Ç—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω—É–∂–µ–Ω –¥–µ—Ñ–æ–ª—Ç

    # ‚Äî –ü—Ä–æ—á–∏–π —Å–æ—Ä—Ç–æ–≤–æ–π –ø—Ä–æ–∫–∞—Ç (–Ω–µ–ª–µ–≥–∏—Ä. —Å—Ç–∞–ª—å) ‚Äî
    (re.compile(r'\b–∫–≤–∞–¥—Ä–∞—Ç\b', re.I),        '24.10.62.122'),
    (re.compile(r'\b—à–µ—Å—Ç–∏–≥—Ä–∞–Ω–Ω–∏–∫\b', re.I),   '24.10.62.123'),
    (re.compile(r'\b–ø–æ–ª–æ—Å[–∞—ã]\b', re.I),      '24.10.62.124'),

    # ‚Äî –õ–∏—Å—Ç—ã / –ø–ª–∏—Ç—ã ‚Äî
    (re.compile(r'\b–ª–∏—Å—Ç\s*(–≥/–∫|–≥–æ—Ä—è—á\w*)\b', re.I), '24.10.31.000'),  # –ª–∏—Å—Ç –≥–æ—Ä—è—á–µ–∫–∞—Ç–∞–Ω—ã–π ‚â•600 –º–º
    (re.compile(r'\b–ª–∏—Å—Ç\s*(—Ö/–∫|—Ö–æ–ª–æ–¥\w*)\b', re.I), '24.10.41.000'),  # –ª–∏—Å—Ç —Ö–æ–ª–æ–¥–Ω–æ–∫–∞—Ç–∞–Ω—ã–π ‚â•600 –º–º
    (re.compile(r'\b–ª–∏—Å—Ç\b', re.I),                 '24.10.41.000'),   # –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã–π –¥–µ—Ñ–æ–ª—Ç: —Ö/–∫
    (re.compile(r'\b–ø–ª–∏—Ç[–∞—ã]\b', re.I),             '24.10.31.000'),   # —Ç–æ–ª—Å—Ç–æ–ª–∏—Å—Ç (–ø–ª–∏—Ç–∞) = –≥/–∫

    # ‚Äî –®—Ç—Ä–∏–ø—Å / –ª–µ–Ω—Ç–∞ ‚Äî
    (re.compile(r'\b(—à—Ç—Ä–∏–ø—Å|–ª–µ–Ω—Ç[–∞—ã])\b', re.I), '24.32.10.000'),      # —É–∑–∫–∏–π —Ö/–∫ –ø—Ä–æ–∫–∞—Ç <600 –º–º, –Ω–µ–ø–ª–∞–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π

    # ‚Äî –¢—Ä—É–±—ã ‚Äî
    # (re.compile(r'\b—Ç—Ä—É–±[–∞—ã]\s*–∫—Ä—É–≥–ª\w*\b', re.I), '24.20.13'),        # –ö—Ä—É–≥–ª—ã–µ —Ç—Ä—É–±—ã –±—ã–≤–∞—é—Ç –∏ –±–µ—Å—à–æ–≤–Ω—ã–µ (24.20.13), –∏ —ç–ª–µ–∫—Ç—Ä–æ—Å–≤–∞—Ä–Ω—ã–µ (24.20.14)
    (re.compile(r'\b—Ç—Ä—É–±[–∞—ã]\b.*\b–±–µ—Å—à–æ–≤–Ω\w*\b', re.I), '24.20.13'),   # –±–µ—Å—à–æ–≤–Ω—ã–µ
    (re.compile(r'\b—Ç—Ä—É–±[–∞—ã]\b.*\b(–±–µ—Å—à–æ–≤–Ω\w*|–≥–æ—Ä—è—á–µ–¥–µ—Ñ–æ—Ä–º\w*|—Ö–æ–ª–æ–¥–Ω–æ–¥–µ—Ñ–æ—Ä–º\w*|–ì–î\b|–•–î\b)\b', re.I), '24.20.13'),
    (re.compile(r'\b—Ç—Ä—É–±[–∞—ã]\b.*\b(—ç–ª–µ–∫—Ç—Ä–æ—Å–≤–∞—Ä\w*|—Å–≤–∞—Ä–Ω\w*|–ø—Ä—è–º–æ—à–æ–≤–Ω\w*|—Å–ø–∏—Ä–∞–ª[—å–∏][-\s]?—à–æ–≤–Ω\w*|–≠–°–í\b|ERW\b)\b', re.I), '24.20.14'),
    (re.compile(r'\b—Ç—Ä—É–±[–∞—ã]\b.*\b(—ç–ª–µ–∫—Ç—Ä–æ—Å–≤–∞—Ä\w*|—Å–≤–∞—Ä–Ω\w*)\b', re.I), '24.20.14'),   # —Å–≤–∞—Ä–Ω—ã–µ
    (re.compile(r'\b—Ç—Ä—É–±[–∞—ã]\b', re.I), '24.20'),        # –ª—é–±—ã–µ —Ç—Ä—É–±—ã/–ø—É—Å—Ç–æ—Ç–µ–ª—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏ ‚Äî –æ–±—â–∏–π –∫–ª–∞—Å—Å

    # ‚Äî ¬´–ü—Ä–æ—Ñ–∏–ª—å¬ª –∫–∞–∫ —Å–ª–æ–≤–æ —Å–∞–º–æ –ø–æ —Å–µ–±–µ —Å–ª–∏—à–∫–æ–º –æ–±—â–µ–µ: –Ω–µ –º–∞–ø–ø–∏–º –±–µ–∑ —É—Ç–æ—á–Ω–µ–Ω–∏–π
    # (re.compile(r'\b–ø—Ä–æ—Ñ–∏–ª\w*\b', re.I), None)
    (re.compile(r'\b(?:—à–∞–π–±[–∞–∏]\s*–ø—Ä—É–∂–∏–Ω–Ω\w*|–≥—Ä–æ–≤–µ—Ä\w*)\b', re.I), '25.94.12.110'),
    
    # üé® === –õ–ê–ö–û–ö–†–ê–°–û–ß–ù–´–ï –ú–ê–¢–ï–†–ò–ê–õ–´ ===
    (re.compile(r'\b–∫—Ä–∞—Å–∫[–∞–∏]\w*\s+(?:–ü–§|–ú–ê|–≠–ü|–ì–§|–•–í|–ù–¶|–ê–ö|–£–†|–ö–û|–•–°|–í–õ)', re.I), '20.30.11'),
    (re.compile(r'\b—ç–º–∞–ª—å\w*\s+(?:–ü–§|–ú–õ|–ù–¶|–ì–§|–≠–ü)', re.I), '20.30.12'),
    (re.compile(r'\b–≥—Ä—É–Ω—Ç(?:–æ–≤–∫)?\w*', re.I), '20.30.12.110'),
    (re.compile(r'\b–ª–∞–∫\w*', re.I), '20.30.12.120'),
    (re.compile(r'\b—à–ø–∞—Ç–ª[–µ—ë]–≤–∫\w*', re.I), '20.30.12.130'),
    (re.compile(r'\b—Ä–∞—Å—Ç–≤–æ—Ä–∏—Ç–µ–ª[—å—è]\w*', re.I), '20.30.22'),
    (re.compile(r'\b(?:–∞—Ü–µ—Ç–æ–Ω|—Ç–æ–ª—É–æ–ª|–∫—Å–∏–ª–æ–ª|—É–∞–π—Ç-—Å–ø–∏—Ä–∏—Ç|—Å–æ–ª—å–≤–µ–Ω—Ç)\b', re.I), '20.30.22'),
    
    # üîå === –≠–õ–ï–ö–¢–†–û–ù–ù–´–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´ ===
    (re.compile(r'\b—Ç—Ä–∞–Ω–∑–∏—Å—Ç–æ—Ä\w*', re.I), '26.11.22'),
    (re.compile(r'\b—Ä–µ–∑–∏—Å—Ç–æ—Ä\w*', re.I), '27.90.60.000'),
    (re.compile(r'\b–∫–æ–Ω–¥–µ–Ω—Å–∞—Ç–æ—Ä\w*', re.I), '27.90.52'),
    (re.compile(r'\b–¥–∏–æ–¥\w*', re.I), '26.11.21.110'),
    (re.compile(r'\b–º–∏–∫—Ä–æ—Å—Ö–µ–º\w*', re.I), '26.11.30'),
    (re.compile(r'\b—Ä–µ–ª–µ\w*', re.I), '27.12.24'),
    (re.compile(r'\b–∫–æ–Ω—Ç–∞–∫—Ç–æ—Ä\w*', re.I), '27.33.13.140'),
    (re.compile(r'\b–ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª\w*', re.I), '27.33.11.160'),
    (re.compile(r'\b—Ä–∞–∑—ä[–µ—ë]–º\w*', re.I), '27.33.13'),
    (re.compile(r'\b—Å–æ–µ–¥–∏–Ω–∏—Ç–µ–ª\w*', re.I), '27.33.13'),
    (re.compile(r'\b—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ç–æ—Ä\w*', re.I), '27.11.4'),
    (re.compile(r'\b–¥—Ä–æ—Å—Å–µ–ª\w*', re.I), '27.33.13.164'),
    (re.compile(r'\b–ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª\w*', re.I), '27.12.21'),
    
    # === –ü–†–û–ß–ò–ï –ú–ê–¢–ï–†–ò–ê–õ–´ ===
    (re.compile(r'\b(?:—Å–º–∞–∑–∫|—Å–æ–ª–∏–¥–æ–ª|–ª–∏—Ç–æ–ª|—Ü–∏–∞—Ç–∏–º|–∫–æ–Ω—Å—Ç–∞–ª–∏–Ω)\w*', re.I), '20.59.41'),  # —Å–º–∞–∑–æ—á–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã
    (re.compile(r'\b–∫–ª–µ[–π—è–µ]\w*', re.I),          '20.52'),          # –∫–ª–µ–∏, —Å–µ–º–µ–π—Å—Ç–≤–æ 20.52 
    (re.compile(r'\b–≥–µ—Ä–º–µ—Ç–∏–∫\w*|–≥–µ—Ä–º–µ—Ç–∏–∑–∞—Ç–æ—Ä\w*', re.I), '20.30.22.170'),  # –≥–µ—Ä–º–µ—Ç–∏–∫–∏ (–õ–ö–ú/–º–∞—Å—Ç–∏–∫–∏) 
    (re.compile(r'\b(—Ñ—Ç–æ—Ä–æ–ø–ª–∞—Å—Ç|–∫–∞–ø—Ä–æ–ª–æ–Ω)\b(?=.*\b(–ø—Ä—É—Ç–æ–∫|—Å—Ç–µ—Ä–∂–µ–Ω—å|–∫—Ä—É–≥)\b)', re.I), '22.21.10.120'),  # –ø—Ä—É—Ç–∫–∏/—Å—Ç–µ—Ä–∂–Ω–∏ –ø–ª–∞—Å—Ç–º–∞—Å—Å–æ–≤—ã–µ 
    (re.compile(r'\b(—Ñ—Ç–æ—Ä–æ–ø–ª–∞—Å—Ç|–∫–∞–ø—Ä–æ–ª–æ–Ω)\b(?=.*\b(–ª–∏—Å—Ç|–ø–ª–∏—Ç–∞|–ø–ª–∞—Å—Ç–∏–Ω)\w*\b)', re.I), '22.21.30'),     # –ª–∏—Å—Ç—ã/–ø–ª–∏—Ç—ã –ø–æ–ª–∏–º–µ—Ä–Ω—ã–µ (–Ω–µ–∞—Ä–º.)
    (re.compile(r'\b(—Ñ—Ç–æ—Ä–æ–ø–ª–∞—Å—Ç|–∫–∞–ø—Ä–æ–ª–æ–Ω)\b', re.I), '22.21.30'),  # –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–µ—Ñ–æ–ª—Ç –Ω–∞ –ª–∏—Å—Ç/–ø–ª–∏—Ç—É
    (re.compile(r'\b—Å—Ç–µ–∫–ª–æ—Ç–µ–∫—Å—Ç–æ–ª–∏—Ç\w*\b', re.I), '23.14.12.190'),  # –∏–∑–¥–µ–ª–∏—è –∏–∑ —Å—Ç–µ–∫–ª–æ–≤–æ–ª–æ–∫–Ω–∞ –ø—Ä–æ—á–∏–µ (–ª–∏—Å—Ç–æ–≤–æ–π –°–¢–≠–§ –∏ —Ç.–ø.)
    (re.compile(r'\b(—Ç–µ–∫—Å—Ç–æ–ª–∏—Ç|–≥–µ—Ç–∏–Ω–∞–∫—Å)\w*\b', re.I), '23.99.19'), # –ø—Ä–æ—á–∏–µ –Ω–µ–º–µ—Ç–∞–ª–ª–∏—á. –º–∏–Ω–µ—Ä–∞–ª—å–Ω—ã–µ –∏–∑–¥–µ–ª–∏—è (–ª–∏—Å—Ç–æ–≤–æ–π —ç–ª–µ–∫—Ç—Ä–æ–∏–∑–æ–ª—è—Ü. –ø–ª–∞—Å—Ç–∏–∫)
    (re.compile(r'\b–≤–æ–π–ª–æ–∫\w*\b', re.I),  '13.99.13.190'),   # —Ñ–µ—Ç—Ä –∏ –≤–æ–π–ª–æ–∫ –ø—Ä–æ—á–∏–µ (—Ç–µ—Ö. –≤–æ–π–ª–æ–∫)
    (re.compile(r'\b–ø–∞—Ä–æ–Ω–∏—Ç\w*\b', re.I), '23.99.11.130'),   # –∏–∑–¥–µ–ª–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞—Å–±–µ—Å—Ç–∞/–ø–∞—Ä–æ–Ω–∏—Ç (–ª–∏—Å—Ç/–ø—Ä–æ–∫–ª–∞–¥–∫–∏)
    (re.compile(r'\b—Ä–µ–∑–∏–Ω\w+|\b–†–¢–ò\b', re.I),          '22.19.73'), # –æ–±—â–∞—è –∫–æ—Ä–∑–∏–Ω–∞ –∏–∑–¥–µ–ª–∏–π –∏–∑ –≤—É–ª–∫–∞–Ω–∏–∑–∏—Ä. —Ä–µ–∑–∏–Ω—ã –Ω.–≤.–¥.–≥.
    (re.compile(r'\b–∫–æ–ª—å—Ü\w+\s+—Ä–µ–∑–∏–Ω\w+\s+—É–ø–ª–æ—Ç–Ω–∏—Ç\w*', re.I), '22.19.73.111'), # O-rings –∏ —Ç.–ø.
    (re.compile(r'\b—É–ø–ª–æ—Ç–Ω–∏—Ç\w+.*\b—Ä–µ–∑–∏–Ω\w*', re.I),   '22.19.73.114'),   # —Ä–µ–∑–∏–Ω–æ–≤—ã–µ —É–ø–ª–æ—Ç–Ω–∏—Ç–µ–ª–∏
    (re.compile(r'\b–ø—Ä–æ–≤–æ–ª–æ–∫[–∞–∏]\b', re.I), '24.34'),
    (re.compile(r'\b—Å–µ—Ç–∫[–∞–∏]\b', re.I), '25.93.13'),  # —Å–µ—Ç–∫–∏/—Ä–µ—à—ë—Ç–∫–∏ –∏–∑ –ø—Ä–æ–≤–æ–ª–æ–∫–∏ (Fe/Cu)
    (re.compile(r'\b–∫–∞–Ω–∞—Ç\w*', re.I), '25.93.11.120'),
    (re.compile(r'\b—Ç—Ä–æ—Å\w*', re.I), '25.93.11.120'),
    (re.compile(r'\b—ç–ª–µ–∫—Ç—Ä–æ–¥\w*\s*(?:–≥—Ä–∞—Ñ–∏—Ç\w*|—É–≥–æ–ª—å–Ω\w*|—É–≥–ª–µ—Ä–æ–¥\w*)', re.I), '27.90.13.110'), # –ì—Ä–∞—Ñ–∏—Ç–æ–≤—ã–µ / —É–≥–ª–µ—Ä–æ–¥–Ω—ã–µ —ç–ª–µ–∫—Ç—Ä–æ–¥—ã (—ç–ª–µ–∫—Ç—Ä–æ—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ)
    (re.compile(r'(?i)(?=.*\b(–≤–æ–ª—å—Ñ—Ä–∞–º\w*)\b)(?=.*\b(TIG|GTAW)\b)(?=.*\b(—Å—Ç–µ—Ä–∂–Ω\w+|–ø—Ä—É—Ç\w+)\b)'
            r'(?!.*\b(–ø—Ä–∏—Å–∞–¥–æ—á\w*|rod\b|ER[0-9A-Z\-]+)\b)'), '24.45.30.110'),
    (re.compile(r'(?:\b–ø—Ä–∏—Å–∞–¥–æ—á\w+\b.*\b(?:–ø—Ä—É—Ç\w+|—Å—Ç–µ—Ä–∂–Ω\w+|rod)\b|\bER[0-9A-Z\-]+\b)', re.I), '25.93.15.110'),
    (re.compile(r'(?i)(?=.*\b—ç–ª–µ–∫—Ç—Ä–æ–¥\w+\b)'
        r'(?=.*\b(–≤–æ–ª—å—Ñ—Ä–∞–º\w*|TIG|GTAW|WT-?\d{2}|WL-?\d{2}|WP\b|EW(?:Th|La|Ce|Zr)[-\s]?\d(?:\.\d)?)\b)'
        r'(?!.*\b(–ø—Ä–∏—Å–∞–¥–æ—á\w*|rod\b|ER[0-9A-Z\-]+)\b)'), '24.45.30.110'), # 2) –í–æ–ª—å—Ñ—Ä–∞–º–æ–≤—ã–µ –Ω–µ–ø–ª–∞–≤—è—â–∏–µ—Å—è —ç–ª–µ–∫—Ç—Ä–æ–¥—ã TIG/GTAW ‚Üí 24.45.30.110
    (re.compile(r'\b–ø—Ä–æ–≤–æ–ª–æ–∫\w*\s*(?:—Å\s*—Ñ–ª—é—Å\w*|—Ñ–ª—é—Å\w*|flux(?:\s*core)?\w*)', re.I), '25.93.15.130'), # –ü—Ä–æ–≤–æ–ª–æ–∫–∞ —Å —Ñ–ª—é—Å–æ–º (FCAW)
    (re.compile(r'(?:\b–ø—Ä–∏—Å–∞–¥–æ—á\w+\b.*\b(?:–ø—Ä—É—Ç\w+|—Å—Ç–µ—Ä–∂–Ω\w+|rod)\b|\bER[0-9A-Z\-]+\b)', re.I), '25.93.15.110'), # –ü—Ä–∏—Å–∞–¥–æ—á–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –±–µ–∑ –ø–æ–∫—Ä—ã—Ç–∏—è (–ø—Ä—É—Ç–∫–∏/—Å—Ç–µ—Ä–∂–Ω–∏/–ø–ª–∞—Å—Ç–∏–Ω—ã, TIG rod –∏ —Ç.–ø.)
    (re.compile(r'(?:\b–ø—Ä–∏—Å–∞–¥–æ—á\w+\b.*\b(–ø—Ä—É—Ç\w+|—Å—Ç–µ—Ä–∂–Ω\w+|–ø–ª–∞—Å—Ç–∏–Ω\w+))|(?:\bTIG\b.*\b(rod|–ø—Ä—É—Ç\w+|—Å—Ç–µ—Ä–∂–Ω\w+))', re.I), '25.93.15.110'),

    (re.compile(r'\b—ç–ª–µ–∫—Ç—Ä–æ–¥\w+\b.*\b(—Å\s*–ø–æ–∫—Ä—ã—Ç–∏\w*|–ú–ú–ê\b|—Ä—É—á–Ω\w*\s*–¥—É–≥–æ–≤\w*\s*—Å–≤–∞—Ä–∫\w*|SMAW\b)', re.I), '25.93.15.120'), # –≠–ª–µ–∫—Ç—Ä–æ–¥—ã —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º / –ú–ú–ê / —Ä—É—á–Ω–∞—è –¥—É–≥–æ–≤–∞—è —Å–≤–∞—Ä–∫–∞
    (re.compile(r'\b—ç–ª–µ–∫—Ç—Ä–æ–¥\w+\b.*\b—Å–≤–∞—Ä–∫\w+', re.I), '25.93.15.120'), # –û–±—â–∏–π —Ñ–æ–ª–±—ç–∫: –µ—Å–ª–∏ ¬´—ç–ª–µ–∫—Ç—Ä–æ–¥¬ª + ¬´—Å–≤–∞—Ä–∫¬ª –±–µ–∑ –¥—Ä—É–≥–æ–π –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∏ ‚Äî —Å—á–∏—Ç–∞–µ–º –ø–æ–∫—Ä—ã—Ç—ã–º–∏

    (re.compile(r'(?:\b—Å–ø–∏—Ü\w*\s*–≤—è–∑–∞–ª—å–Ω\w*|\b–∫—Ä—é—á–∫\w*\s*–≤—è–∑–∞–ª—å–Ω\w*|' r'\b–∏–≥–ª\w*\s*(?:—à—Ç–æ–ø–∞–ª—å–Ω\w*|–¥–ª—è\s*–≤—ã—à–∏–≤–∫\w*)\b)', re.I),'25.93.18.120'), # ‚Äî –í—è–∑–∞–Ω–∏–µ/–≤—ã—à–∏–≤–∫–∞/—à—Ç–æ–ø–∫–∞/–∫—Ä—é—á–∫–∏/—Å–ø–∏—Ü—ã ‚Üí 25.93.18.120
    (re.compile(r'\b(–∏–≥–ª\w*|–∏–≥–æ–ª–∫\w*)\b.*\b(—à–≤–µ–π–Ω\w*|–¥–ª—è\s*—à–∏—Ç—å—è|–º–∞—à–∏–Ω–Ω\w*|–ø–µ—Ä–µ–ø–ª–µ—Ç\w*|–ø—Ä–æ—à–∏–≤–∫\w*)', re.I),'25.93.18.110'),
    (re.compile(r'\b–ø–æ–¥—à–∏–ø–Ω–∏–∫\w*\s*(?:–∫–∞—á–µ–Ω–∏[—è–π]\s*)?(?:—Ä–æ–ª–∏–∫\w*\s*)?–∏–≥–æ–ª—å—á–∞—Ç\w*', re.I), '28.15.10.128'), # –ü–æ–¥—à–∏–ø–Ω–∏–∫–∏ –∫–∞—á–µ–Ω–∏—è —Ä–æ–ª–∏–∫–æ–≤—ã–µ –∏–≥–æ–ª—å—á–∞—Ç—ã–µ
    (re.compile(r'\b(?:–∏–≥–æ–ª—å—á–∞—Ç\w*\s*—Ä–æ–ª–∏–∫\w*|—Ä–æ–ª–∏–∫\w*\s*–∏–≥–æ–ª—å—á–∞—Ç\w*)\b', re.I), '28.15.31.120'), # –†–æ–ª–∏–∫–∏ –∏–≥–æ–ª—å—á–∞—Ç—ã–µ (–¥–µ—Ç–∞–ª–∏ –ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤)
]


def extract_material_info(text: str) -> Dict[str, Any]:
    """–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –º–∞—Ç–µ—Ä–∏–∞–ª–µ –∏–∑ —Å—Ç—Ä–æ–∫–∏ –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã"""
    info = {
        'type': None,        # –ü–ª–∏—Ç–∞, –õ–∏—Å—Ç, –ö—Ä—É–≥ –∏ —Ç.–¥.
        'size': None,        # –†–∞–∑–º–µ—Ä/—Ç–æ–ª—â–∏–Ω–∞
        'gost': [],          # –°–ø–∏—Å–æ–∫ –ì–û–°–¢–æ–≤
        'tu': None,          # –¢–£
        'ost': None,         # –û–°–¢
        'din': None,         # DIN
        'iso': None,         # ISO
        'material': None,    # –ú–∞—Ä–∫–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–∞
        'material_code': None, # –û–ö–ü–î2 –¥–ª—è –º–∞—Ç–µ—Ä–∏–∞–ª–∞
        'features': {}       # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
    }
    
    # –¢–∏–ø –∏–∑–¥–µ–ª–∏—è (—Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫)
    type_patterns = [
        '–ü–ª–∏—Ç–∞', '–õ–∏—Å—Ç', '–ö—Ä—É–≥', '–ü—Ä—É—Ç–æ–∫', '–õ–µ–Ω—Ç–∞', '–ü–æ–ª–æ—Å–∞',
        '–ü—Ä–æ—Ñ–∏–ª—å', '–®–≤–µ–ª–ª–µ—Ä', '–î–≤—É—Ç–∞–≤—Ä', '–£–≥–æ–ª–æ–∫', '–ë–∞–ª–∫–∞',
        '–¢—Ä—É–±–∞', '–ö–≤–∞–¥—Ä–∞—Ç', '–®–µ—Å—Ç–∏–≥—Ä–∞–Ω–Ω–∏–∫',
        '–ë–æ–ª—Ç', '–í–∏–Ω—Ç', '–ì–∞–π–∫–∞', '–®–∞–π–±–∞', '–®—Ç–∏—Ñ—Ç', '–®–ø–∏–ª—å–∫–∞',
        '–ó–∞–≥–æ—Ç–æ–≤–∫–∞', '–û—Ç–ª–∏–≤–∫–∞', '–ü–æ–∫–æ–≤–∫–∞',
        '–ü—Ä–æ–≤–æ–ª–æ–∫–∞', '–ö–∞–Ω–∞—Ç', '–¢—Ä–æ—Å', '–°–µ—Ç–∫–∞'
    ]
    
    for pattern in type_patterns:
        if re.match(rf'^{pattern}\b', text, re.I):
            info['type'] = pattern.upper()
            break
    # "–®—Ç—Ä–∏–ø—Å" ‚Äî —ç—Ç–æ –ª–µ–Ω—Ç–∞
    if not info['type'] and re.search(r'\b—à—Ç—Ä–∏–ø—Å\w*\b', text, re.I):
        info['type'] = '–õ–ï–ù–¢–ê'

    # –†–∞–∑–º–µ—Ä (—É–ª—É—á—à–µ–Ω–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ)
    if info['type']:
        # –î–ª—è –∫—Ä–µ–ø–µ–∂–∞ - —Ä–∞–∑–º–µ—Ä —Ä–µ–∑—å–±—ã
        if info['type'] in ['–ë–û–õ–¢', '–í–ò–ù–¢', '–ì–ê–ô–ö–ê', '–®–ü–ò–õ–¨–ö–ê']:
            size_match = re.search(r'–ú(\d+)(?:[x—Ö](\d+))?', text, re.I)
            if size_match:
                info['size'] = f"M{size_match.group(1)}"
                if size_match.group(2):
                    info['features']['length'] = size_match.group(2)
        # –î–ª—è –ª–∏—Å—Ç–æ–≤/–ø–ª–∏—Ç - —Ç–æ–ª—â–∏–Ω–∞
        elif info['type'] in ['–ü–õ–ò–¢–ê', '–õ–ò–°–¢', '–ü–û–õ–û–°–ê', '–õ–ï–ù–¢–ê']:
            # –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º "—Ç–æ–ª—â–∏–Ω–∞ x —à–∏—Ä–∏–Ω–∞"
            dim = re.search(r'(\d+(?:[.,]\d+)?)\s*[x—Ö√ó]\s*(\d+(?:[.,]\d+)?)', text)
            if dim:
                t = dim.group(1).replace(',', '.')
                w = dim.group(2).replace(',', '.')
                info['features']['thickness'] = t
                info['features']['width'] = w
                info['size'] = t  # –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏ size ‚Äî ¬´–≤–µ–¥—É—â–∞—è¬ª —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å
            else:
                # –ò–Ω–∞—á–µ —Ö–æ—Ç—è –±—ã ¬´—Ç–æ–ª—â–∏–Ω—É¬ª
                size_match = re.search(r'(?:^|\s)(\d+(?:[.,]\d+)?)\b', text)
                if size_match:
                    info['size'] = size_match.group(1).replace(',', '.')
        # –î–ª—è –∫—Ä—É–≥–ª–æ–≥–æ –ø—Ä–æ–∫–∞—Ç–∞ - –¥–∏–∞–º–µ—Ç—Ä
        elif info['type'] in ['–ö–†–£–ì', '–ü–†–£–¢–û–ö', '–ü–†–û–í–û–õ–û–ö–ê']:
            size_match = re.search(r'(?:^|\s|√ò|D|d)(\d+(?:[,\.]\d+)?)\b', text)
            if size_match:
                info['size'] = size_match.group(1).replace(',', '.')
        # –î–ª—è –ø—Ä–æ—Ñ–∏–ª–µ–π - —Ä–∞–∑–º–µ—Ä—ã
        elif info['type'] in ['–£–ì–û–õ–û–ö', '–®–í–ï–õ–õ–ï–†', '–î–í–£–¢–ê–í–†', '–ü–†–û–§–ò–õ–¨']:
            size_match = re.search(r'(\d+)[x—Ö](\d+)(?:[x—Ö](\d+))?', text)
            if size_match:
                dims = [size_match.group(1), size_match.group(2)]
                if size_match.group(3):
                    dims.append(size_match.group(3))
                info['size'] = 'x'.join(dims)
    
    # –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã
    for gm in GOST_RE.finditer(text or ''):
        base = gm.group(2)                 # –º–æ–∂–µ—Ç –±—ã—Ç—å —Å —Ç–æ—á–∫–æ–π, –∫–∞–∫ 11326.37
        num  = base.split('-')[0]          # —Å–æ—Ö—Ä–∞–Ω—è–µ–º .XX (–Ω–µ —Ä–µ–∂–µ–º –ø–æ '.')
        if num not in info['gost']:
            info['gost'].append(num)
    
    tu_match = re.search(r'–¢–£\s*([\d\-\.]+)', text, re.I)
    if tu_match:
        info['tu'] = tu_match.group(1)
    
    ost_match = re.search(r'–û–°–¢\s*([\d\s\-]+)', text, re.I)
    if ost_match:
        info['ost'] = ost_match.group(1).strip()
    
    din_match = re.search(r'DIN\s*(\d+)', text, re.I)
    if din_match:
        info['din'] = din_match.group(1)
    
    iso_match = re.search(r'ISO\s*(\d+(?:[-\.]\d+)?)', text, re.I)
    if iso_match:
        info['iso'] = iso_match.group(1)
    
    # –ú–∞—Ç–µ—Ä–∏–∞–ª (—É–ª—É—á—à–µ–Ω–Ω–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ)
    # –ò—â–µ–º –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–π —á–∞—Å—Ç–∏ –ø–æ—Å–ª–µ —Å–ª—ç—à–∞ –∏–ª–∏ –≤–æ –≤—Å–µ–º —Ç–µ–∫—Å—Ç–µ
    material_part = text.split('/')[-1] if '/' in text else text
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –∏–∑–≤–µ—Å—Ç–Ω—ã–º –º–∞—Ä–∫–∞–º —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º
    material_found = False
    for pattern, (code, name_tpl) in MATERIAL_GRADES.items():
        m = re.search(pattern, material_part, re.I)
        if m:
            try:
                info['material'] = m.expand(name_tpl)
            except re.error:
                info['material'] = name_tpl   
            info['material_code'] = code
            material_found = True
            break
    
    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∞
    if not material_found:
        # –ü—Ä–æ—Å—Ç—ã–µ –º–∞—Ä–∫–∏ —Å—Ç–∞–ª–∏
        steel_match = re.search(r'\b(–°—Ç\.?\s*\d+\w*)\b', material_part, re.I)
        if steel_match:
            info['material'] = steel_match.group(1)
            info['material_code'] = '24.10.61'
        # –õ—é–±—ã–µ –¥—Ä—É–≥–∏–µ –º–∞—Ä–∫–∏
        else:
            patterns = [
                r'\b([–ê-–Ø]{1,3}\d+[–ê-–Ø]*(?:-[–ê-–Ø]+)?)\b',  # –ê–ú–≥6, –í–¢5-1
                r'\b(\d{4}[–ê-–Ø]?)\b',  # 1561–ë
                r'\b(\d{1,2}[–•X][\d–ê-–Ø]+)\b',  # 12–•18–ù10–¢
            ]
            for pattern in patterns:
                match = re.search(pattern, material_part)
                if match:
                    info['material'] = match.group(1)
                    break
    
    # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏
    if re.search(r'\b(?:—à–ª–∏—Ñ–æ–≤–∞–Ω|–ø–æ–ª–∏—Ä–æ–≤–∞–Ω|–º–∞—Ç–æ–≤)\w*\b', text, re.I):
        info['features']['surface'] = '–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è'
    
    # –¢–µ—Ä–º–æ–æ–±—Ä–∞–±–æ—Ç–∫–∞
    if re.search(r'\b(?:–∑–∞–∫–∞–ª–µ–Ω|–æ—Ç–æ–∂–∂–µ–Ω|–Ω–æ—Ä–º(?:–∞–ª–∏–∑)?)\w*\b', text, re.I):
        info['features']['heat_treatment'] = True
    
    # –ü–æ–∫—Ä—ã—Ç–∏–µ
    if re.search(r'\b(?:–æ—Ü–∏–Ω–∫–æ–≤–∞–Ω|—Ö—Ä–æ–º–∏—Ä–æ–≤–∞–Ω|–Ω–∏–∫–µ–ª–∏—Ä–æ–≤–∞–Ω|–∫–∞–¥–º–∏—Ä–æ–≤–∞–Ω)\w*\b', text, re.I):
        info['features']['coating'] = True
    
    mW = re.search(r'—à–∏—Ä(?:\.|–∏–Ω–∞)?\s*[:=]?\s*(\d+(?:[.,]\d+)?)\s*(?:–º–º|mm)\b', text, re.I)
    if mW:
        info['features']['width'] = mW.group(1).replace(',', '.')

    return info

def classify_factory_item(text: str) -> Tuple[str, float, str, Dict]:
    """
    –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä—ã –∑–∞–≤–æ–¥–∞
    –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: (–∫–æ–¥ –û–ö–ü–î2, —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å, –æ–ø–∏—Å–∞–Ω–∏–µ, –¥–æ–ø.–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)
    """
    info = extract_material_info(text)

    # --- –°–¢–†–ê–•–û–í–ö–ê: –∏–≥–æ–ª—å—á–∞—Ç—ã–µ –ø–æ–¥—à–∏–ø–Ω–∏–∫–∏ –¥–æ –ª—é–±—ã—Ö "–∏–≥–æ–ª"/"–∏–≥–ª–∞" ---
    if re.search(r'\b–ø–æ–¥—à–∏–ø–Ω–∏–∫\w*\b.*\b(NA\d|NK\d|HK\d|RNA\d|NKI\d|NKIS\d)\b', text, re.I):
        return '28.15.10.128', 0.94, '–ø–æ–¥—à–∏–ø–Ω–∏–∫ –∏–≥–æ–ª—å—á–∞—Ç—ã–π (—Å–µ—Ä–∏–∏ NA/NK/HK/‚Ä¶)', info

    if re.search(r'\b–ø–æ–¥—à–∏–ø–Ω–∏–∫\w*\s*(?:–∫–∞—á–µ–Ω–∏[—è–π]\s*)?(?:—Ä–æ–ª–∏–∫\w*\s*)?–∏–≥–æ–ª—å—á–∞—Ç\w*', text, re.I):
        return '28.15.10.128', 0.96, '–ø–æ–¥—à–∏–ø–Ω–∏–∫ –∏–≥–æ–ª—å—á–∞—Ç—ã–π', info

    if re.search(r'\b(?:–∏–≥–æ–ª—å—á–∞—Ç\w*\s*—Ä–æ–ª–∏–∫\w*|—Ä–æ–ª–∏–∫\w*\s*–∏–≥–æ–ª—å—á–∞—Ç\w*)\b', text, re.I):
        return '28.15.31.120', 0.95, '—Ä–æ–ª–∏–∫–∏ –∏–≥–æ–ª—å—á–∞—Ç—ã–µ (–¥–µ—Ç–∞–ª–∏ –ø–æ–¥—à–∏–ø–Ω–∏–∫–æ–≤)', info

    # --- —Ç—Ä—É–±–æ–ø—Ä–æ–≤–æ–¥–Ω–∞—è –∞—Ä–º–∞—Ç—É—Ä–∞ (–æ—Å—Ç–æ—Ä–æ–∂–Ω–∞—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∞) ---
    if (re.search(r'\b(?:–≤–µ–Ω—Ç–∏–ª\w*|–∫–ª–∞–ø–∞–Ω\w*|–∑–∞–¥–≤–∏–∂–∫\w*|–∫—Ä–∞–Ω\w*)\b', text, re.I)
        and re.search(r'\b(?:DN|–î[–£—É]|–î–£)\s*\d+\b|—Ä–µ–∑—å–±\w+|–º—É—Ñ—Ç–æ–≤\w+|—Ñ–ª–∞–Ω—Ü–µ–≤\w+|—Ç—Ä—É–±–æ–ø—Ä–æ–≤–æ–¥\w+', text, re.I)):
        # –±–∞–∑–æ–≤—ã–π –∫–ª–∞—Å—Å –ø–æ –û–ö–ü–î2: –∞—Ä–º–∞—Ç—É—Ä–∞ (–≤–µ–Ω—Ç–∏–ª–∏/–∫–ª–∞–ø–∞–Ω—ã –∏ —Ç.–ø.)
        return okpd_canon('28.14.12'), 0.92, '—Ç—Ä—É–±–æ–ø—Ä–æ–≤–æ–¥–Ω–∞—è –∞—Ä–º–∞—Ç—É—Ä–∞ (–≤–µ–Ω—Ç–∏–ª—å/–∫–ª–∞–ø–∞–Ω/–∑–∞–¥–≤–∏–∂–∫–∞/–∫—Ä–∞–Ω)', info


    # 0) –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: —Ç–∏–ø + –º–∞—Ç–µ—Ä–∏–∞–ª –≤–º–µ—Å—Ç–µ –¥–∞—é—Ç –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–π –∫–æ–¥
    if info['type'] and info['material']:
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–µ–º–µ–π—Å—Ç–≤–æ –º–∞—Ç–µ—Ä–∏–∞–ª–∞
        mat = info['material'].upper()
        fam = None
        
        if (info.get('material_code') or '').startswith('24.42') or any(k in mat for k in ['–ê–ú–ì','–ê–ú–¶','–ê–î','–ê–ö','–î16','–í95','1561','1163','6061','6063','7075']):
            fam = 'AL'
        elif (info.get('material_code') or '').startswith('24.44') or any(k in mat for k in ['–õ–ê–¢–£–ù','–ë–†–û–ù–ó','–ú–ï–î–¨','–ú1','–ú2','–ú3','–õ63','–õ68','–õ–°59']):
            fam = 'CU'
        elif (info.get('material_code') or '').startswith('24.45') or any(k in mat for k in ['INCONEL','HASTELLOY','MONEL','–•–ù','–≠–ò','–≠–ü']):
            fam = 'NI'
        elif ('AISI' in mat) or re.search(r'\b1\.\d{4}\b', mat) or re.search(r'\d+[–•X]\d+[–ùH]\d+', mat):
            fam = 'SS'      # –Ω–µ—Ä–∂–∞–≤–µ–π–∫–∞
        elif any(s in mat for s in ['–õ–ï–ì–ò–†–û–í–ê–ù', '–ü–†–£–ñ–ò–ù', '–ü–û–î–®–ò–ü–ù–ò–ö', '–•–ù', '–•–ì–°–ê']):
            fam = 'FEA'     # –ø—Ä–æ—á–∏–µ –ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ (–∫—Ä–æ–º–µ –Ω–µ—Ä–∂.)
        else:
            fam = 'FE'      # –Ω–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–∞–ª–∏
        
        # –ö–∞—Ä—Ç–∞ —Ç–∏–ø ‚Üí –∫–æ–¥ –ø–æ —Å–µ–º–µ–π—Å—Ç–≤–∞–º –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
        by_fam = {
            'AL': {
                '–ü–õ–ò–¢–ê':'24.42.24','–õ–ò–°–¢':'24.42.24','–ü–û–õ–û–°–ê':'24.42.24','–õ–ï–ù–¢–ê':'24.42.24',
                '–ö–†–£–ì':'24.42.22','–ü–†–£–¢–û–ö':'24.42.22','–ü–†–û–§–ò–õ–¨':'24.42.22','–£–ì–û–õ–û–ö':'24.42.22','–®–í–ï–õ–õ–ï–†':'24.42.22',
                '–¢–†–£–ë–ê':'24.42.26','–ü–†–û–í–û–õ–û–ö–ê':'24.42.23'
            },
            'CU': {
                '–ü–õ–ò–¢–ê':'24.44.24','–õ–ò–°–¢':'24.44.24','–ü–û–õ–û–°–ê':'24.44.24','–õ–ï–ù–¢–ê':'24.44.24',
                '–ö–†–£–ì':'24.44.22','–ü–†–£–¢–û–ö':'24.44.22','–ü–†–û–§–ò–õ–¨':'24.44.22',
                '–¢–†–£–ë–ê':'24.44.26','–ü–†–û–í–û–õ–û–ö–ê':'24.44.23'
            },
            'SS': {
                # –ª–∏—Å—Ç/–ø–ª–∏—Ç–∞ —Ä–µ—à–∏–º –Ω–∏–∂–µ –ø–æ —à–∏—Ä–∏–Ω–µ –∏ –ø—Ä–æ—Ü–µ—Å—Å—É
                '–ö–†–£–ì':'24.10.64','–ü–†–£–¢–û–ö':'24.31.30','–ü–û–õ–û–°–ê':'24.10.64',
                '–£–ì–û–õ–û–ö':'24.10.71','–®–í–ï–õ–õ–ï–†':'24.10.71','–î–í–£–¢–ê–í–†':'24.10.71',
                '–¢–†–£–ë–ê':'24.20'  # –¥–µ—Ç–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –¥–æ 24.20.13/14 –ø–æ–∑–∂–µ, –µ—Å–ª–∏ –ø–æ—è–≤—è—Ç—Å—è –ø—Ä–∏–∑–Ω–∞–∫–∏
            },
            'NI': {
                '–ü–õ–ò–¢–ê':'24.45.24','–õ–ò–°–¢':'24.45.24','–õ–ï–ù–¢–ê':'24.45.24',
                '–ö–†–£–ì':'24.45.22','–ü–†–£–¢–û–ö':'24.45.22','–ü–†–û–í–û–õ–û–ö–ê':'24.45.22','–ü–†–û–§–ò–õ–¨':'24.45.22',
                '–¢–†–£–ë–ê':'24.45.26'
            },
            'FE': {
                # –ª–∏—Å—Ç/–ø–ª–∏—Ç–∞ —Ä–µ—à–∏–º –Ω–∏–∂–µ –ø–æ —à–∏—Ä–∏–Ω–µ –∏ –ø—Ä–æ—Ü–µ—Å—Å—É
                '–ö–†–£–ì':'24.10.62','–ü–†–£–¢–û–ö':'24.31.10','–ö–í–ê–î–†–ê–¢':'24.10.62','–®–ï–°–¢–ò–ì–†–ê–ù–ù–ò–ö':'24.10.62','–ü–û–õ–û–°–ê':'24.10.62',
                '–ü–†–û–§–ò–õ–¨':'24.10.71',
                '–£–ì–û–õ–û–ö':'24.10.71','–®–í–ï–õ–õ–ï–†':'24.10.71','–î–í–£–¢–ê–í–†':'24.10.71','–ë–ê–õ–ö–ê':'24.10.71',
                '–¢–†–£–ë–ê':'24.20','–ü–†–û–í–û–õ–û–ö–ê':'24.34'
            }
        }

        
        code = by_fam.get(fam, by_fam['FE']).get(info['type'])
        # –ï—Å–ª–∏ —É –º–∞—Ç–µ—Ä–∏–∞–ª–∞ –µ—Å—Ç—å —Å–≤–æ–π –û–ö–ü–î2 –∏ –æ–Ω —Å–ø–µ—Ü–∏—Ñ–∏—Ü–∏—á–Ω–µ–µ (–≥–ª—É–±–∂–µ) –±–∞–∑–æ–≤–æ–≥–æ ‚Äî –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º –µ–≥–æ.
        mcode = info.get('material_code')
        if mcode:
            mcode = okpd_canon(mcode)
            def depth(c: Optional[str]) -> int:
                return len((c or '').split('.')) if c else 0
            if depth(mcode) > depth(code):
                # –ø—Ä–∏–º–µ—Ä: –°–≤-08–ì2–° ‚Üí 24.34.13.120 (–≤–º–µ—Å—Ç–æ –æ–±—â–µ–≥–æ 24.34)
                return mcode, 0.95, f"{info['type'].lower()} –∏–∑ {info['material']}", info

        # –ï—Å–ª–∏ —Ñ–æ—Ä–º–∞ –Ω–µ –ª–∏—Å—Ç/–ø–ª–∏—Ç–∞/–ª–µ–Ω—Ç–∞ ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–æ–¥ –ø–æ —Å–µ–º–µ–π—Å—Ç–≤—É —Å—Ä–∞–∑—É
        if code and info['type'] not in ('–õ–ï–ù–¢–ê', '–õ–ò–°–¢', '–ü–õ–ò–¢–ê'):
            fam_name = {
                'AL':'–∞–ª—é–º–∏–Ω–∏–π', 'CU':'–º–µ–¥—å/–ª–∞—Ç—É–Ω—å', 'SS':'–Ω–µ—Ä–∂. —Å—Ç–∞–ª—å',
                'FE':'—Å—Ç–∞–ª—å', 'NI':'Ni-—Å–ø–ª–∞–≤', 'FEA':'–ª–µ–≥–∏—Ä. —Å—Ç–∞–ª—å'
            }.get(fam, '—Å—Ç–∞–ª—å')
            return okpd_canon(code), 0.90, f"{info['type'].lower()} ({fam_name})", info

        if info['type'] == '–õ–ï–ù–¢–ê':
            feats = info.get('features', {}) or {}
            # —à–∏—Ä–∏–Ω–∞
            w = None
            try:
                w = float(str(feats.get('width') or '0').replace(',', '.'))
            except Exception:
                pass

            # –ø–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ –ø—Ä–æ–∫–∞—Ç—É
            txt = text or ''
            cold_hint = bool(re.search(r'(?i)\b(?:—Ö/–∫|—Ö–∫|—Ö–æ–ª–æ–¥–Ω–æ–∫–∞—Ç–∞–Ω\w*)\b', txt))
            hot_hint  = bool(re.search(r'(?i)\b(?:–≥/–∫|–≥–∫|–≥–æ—Ä—è—á–µ–∫–∞—Ç–∞–Ω\w*)\b', txt))
            gosts = set(info.get('gost') or [])
            if '19904' in gosts:  # –ª–∏—Å—Ç —Ö–æ–ª–æ–¥–Ω–æ–∫–∞—Ç–∞–Ω—ã–π ‚â•600
                cold_hint = True
            if '19903' in gosts:  # –ª–∏—Å—Ç –≥–æ—Ä—è—á–µ–∫–∞—Ç–∞–Ω—ã–π ‚â•600
                hot_hint = True

            fam_name = {'AL':'–∞–ª—é–º–∏–Ω–∏–π','CU':'–º–µ–¥—å/–ª–∞—Ç—É–Ω—å','SS':'–Ω–µ—Ä–∂. —Å—Ç–∞–ª—å','FE':'—Å—Ç–∞–ª—å','NI':'Ni-—Å–ø–ª–∞–≤'}.get(fam,'—Å—Ç–∞–ª—å')

            # === –¶–≤–µ—Ç–Ω—ã–µ –º–µ—Ç–∞–ª–ª—ã: –æ—Ç–¥–µ–ª—å–Ω–∞—è –≤–µ—Ç–∫–∞ ===
            if fam in ('AL','CU'):
                if w:
                    if w >= 600:
                        code = '24.42.24.110' if fam == 'AL' else '24.44.24.110'
                        desc = f'–ª–∏—Å—Ç {fam_name} ‚â•600 –º–º'
                        return okpd_canon(code) or code, 0.95, desc, info
                    else:
                        code = '24.42.24.120' if fam == 'AL' else '24.44.24.120'
                        desc = f'–ø–æ–ª–æ—Å–∞/–ª–µ–Ω—Ç–∞ {fam_name} <600 –º–º'
                        return okpd_canon(code), 0.96, desc, info
                # —à–∏—Ä–∏–Ω–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞ ‚Äî –±–µ—Ä—ë–º ¬´–ª–µ–Ω—Ç–∞/–ø–æ–ª–æ—Å–∞¬ª
                code = '24.42.24.120' if fam == 'AL' else '24.44.24.120'
                return okpd_canon(code), 0.88, f'–ª–µ–Ω—Ç–∞ {fam_name} (—Ç–æ–ª—â. >0,2 –º–º), —à–∏—Ä–∏–Ω–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞', info

            # Ni-—Å–ø–ª–∞–≤—ã
            if fam == 'NI':
                return okpd_canon('24.45.24'), 0.93, '–ª–µ–Ω—Ç–∞/–ª–∏—Å—Ç Ni-—Å–ø–ª–∞–≤ (24.45.24)', info


            # === –°—Ç–∞–ª–∏ (FE/SS) ===
            if w:
                if w >= 600:
                    # –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å—á–∏—Ç–∞–µ–º —Ö/–∫, –µ—Å–ª–∏ –Ω–µ—Ç —è–≤–Ω–æ–π –≥–æ—Ä—è—á–µ–∫–∞—Ç–∫–∏
                    if cold_hint or not hot_hint:
                        code = '24.10.42.000' if fam == 'SS' else '24.10.41.000'
                        conf = 0.94 if cold_hint else 0.90
                        return okpd_canon(code), conf, f'–ª–∏—Å—Ç —Ö/–∫ ‚â•600 –º–º ({fam_name})', info
                    else:
                        code = '24.10.33.000' if fam == 'SS' else '24.10.31.000'
                        return okpd_canon(code), 0.94, f'–ª–∏—Å—Ç –≥/–∫ ‚â•600 –º–º ({fam_name})', info
                else:
                    # —É–∑–∫–∞—è —Å—Ç–∞–ª—å–Ω–∞—è –ª–µ–Ω—Ç–∞ / —à—Ç—Ä–∏–ø—Å <600 –º–º
                    is_strip = re.search(r'(?i)\b—à—Ç—Ä–∏–ø—Å\w*\b', txt) is not None
                    code = '24.32.10.000'
                    conf = 0.96 if (cold_hint or '4986' in gosts or is_strip) else 0.90
                    return okpd_canon(code), conf, f'—É–∑–∫–∞—è –ª–µ–Ω—Ç–∞/—à—Ç—Ä–∏–ø—Å <600 –º–º ({fam_name})', info
            # —à–∏—Ä–∏–Ω–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞
            return okpd_canon('24.32.10.000'), 0.88, f'–ª–µ–Ω—Ç–∞ ({fam_name}), —à–∏—Ä–∏–Ω–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞', info
        
        elif info['type'] in ('–õ–ò–°–¢', '–ü–õ–ò–¢–ê'):
            feats = info.get('features', {}) or {}
            # —à–∏—Ä–∏–Ω–∞ (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–∞)
            w = None
            try:
                w = float(str(feats.get('width') or '0').replace(',', '.'))
            except Exception:
                pass

            txt = text or ''
            cold_hint = bool(re.search(r'(?i)\b(?:—Ö/–∫|—Ö–∫|—Ö–æ–ª–æ–¥–Ω–æ–∫–∞—Ç–∞–Ω\w*)\b', txt))
            hot_hint  = bool(re.search(r'(?i)\b(?:–≥/–∫|–≥–∫|–≥–æ—Ä—è—á–µ–∫–∞—Ç–∞–Ω\w*)\b', txt))
            gosts = set(info.get('gost') or [])
            if '19904' in gosts: cold_hint = True
            if '19903' in gosts: hot_hint  = True

            fam_name = {'AL':'–∞–ª—é–º–∏–Ω–∏–π','CU':'–º–µ–¥—å/–ª–∞—Ç—É–Ω—å','SS':'–Ω–µ—Ä–∂. —Å—Ç–∞–ª—å','FE':'—Å—Ç–∞–ª—å','NI':'Ni-—Å–ø–ª–∞–≤'}.get(fam,'—Å—Ç–∞–ª—å')

            # –¶–≤–µ—Ç–Ω—ã–µ ‚Äî —É–∂–µ —Ä–µ—à–µ–Ω—ã –≤ by_fam (24.42.24/24.44.24/24.45.24), –ø—Ä–æ—Å—Ç–æ –≤–µ—Ä–Ω—ë–º –±–∞–∑–æ–≤—ã–π –∫–æ–¥
            if fam in ('AL','CU','NI'):
                base = by_fam[fam][info['type']]
                # –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —à–∏—Ä–∏–Ω—ã ‚â•/< 600 –º–æ–∂–Ω–æ –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å .110/.120, –Ω–æ –±–∞–∑–æ–≤—ã–π –∫–æ–¥ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω
                return okpd_canon(base), 0.90, f"{info['type'].lower()} {fam_name}", info

            # –°—Ç–∞–ª–∏
            # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é ¬´–ø–ª–∏—Ç–∞¬ª —Ç—Ä–∞–∫—Ç—É–µ—Ç—Å—è –∫–∞–∫ ‚â•600 –º–º (–≤–∞—à–∞ –¥–µ—Ñ–æ–ª—Ç-–≥–∏–ø–æ—Ç–µ–∑–∞)
            is_ge600 = (w is None) or (w >= 600)
            if fam == 'SS':
                code = '24.10.42.000' if (cold_hint or not hot_hint) else '24.10.33.000'
            else:
                code = '24.10.41.000' if (cold_hint or not hot_hint) else '24.10.31.000'
            # –µ—Å–ª–∏ —è–≤–Ω–æ —É–∫–∞–∑–∞–Ω–æ <600, —Ç–æ —ç—Ç–æ —Ç–æ–Ω–∫–æ–ª–∏—Å—Ç ‚Äî –Ω–æ –±–µ–∑ —É–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ª—É—á—à–µ –Ω–µ –¥–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–ª—å—à–µ
            return okpd_canon(code), 0.90 if is_ge600 else 0.75, f"{info['type'].lower()} ({fam_name})", info

            
    lower = text.lower()
    is_solder = ('–ø—Ä–∏–ø–æ–π' in lower) or re.search(r'\b–ü–û–°[–ö–°]?(?:[-\s]?\d{2}(?:-\d{1,2})?)?\b', text, re.I)

    if is_solder:
        # —É—Ç–æ—á–Ω—è–µ–º –ø–æ —Ç–∏–ø—É –∏–∑–¥–µ–ª–∏—è (–ì–û–°–¢ 21931-76)
        if info['type'] == '–ü–†–û–í–û–õ–û–ö–ê':
            return '24.43.24.130', 0.94, '–ø—Ä–∏–ø–æ–π, –ø—Ä–æ–≤–æ–ª–æ–∫–∞', info
        if info['type'] in ('–ü–†–£–¢–û–ö', '–ö–†–£–ì'):  # –ø—Ä—É—Ç–æ–∫ –ø—Ä–∏–ø–æ—è —á–∞—Å—Ç–æ –ø–∏—à—É—Ç –∫–∞–∫ ¬´–∫—Ä—É–≥ √ò‚Ä¶¬ª
            return '24.43.24.110', 0.94, '–ø—Ä–∏–ø–æ–π, –ø—Ä—É—Ç–æ–∫', info
        if info['type'] in ('–õ–ï–ù–¢–ê', '–ü–†–û–§–ò–õ–¨', '–ü–û–õ–û–°–ê', '–¢–†–£–ë–ê'):
            # –≤ –û–ö–ü–î2 ¬´–ø—Ä–æ—Ñ–∏–ª–∏ –æ–ª–æ–≤—è–Ω–Ω—ã–µ¬ª ‚Äî –±–ª–∏–∂–∞–π—à–µ–µ –∫ –ª–µ–Ω—Ç–µ/—Ç—Ä—É–±–∫–µ –ø—Ä–∏–ø–æ—è
            return '24.43.24.120', 0.92, '–ø—Ä–∏–ø–æ–π, –ª–µ–Ω—Ç–∞/–ø—Ä–æ—Ñ–∏–ª—å', info
        # —Ñ–æ—Ä–º–∞ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–∞ ‚Äî –æ—Å—Ç–∞–≤–ª—è–µ–º –≥—Ä—É–ø–ø—É –¥–ª—è —Ä—É—á–Ω–æ–π –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏
        return '24.43.24', 0.88, '–ø—Ä–∏–ø–æ–π (—Ñ–æ—Ä–º–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞)', info


    # 1) –ú–∞—Ç–µ—Ä–∏–∞–ª –æ–ø—Ä–µ–¥–µ–ª—ë–Ω, –Ω–æ —Ñ–æ—Ä–º–∞ (—Ç–∏–ø –∏–∑–¥–µ–ª–∏—è) –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–∞ ‚Äî –Ω–µ –≥–∞–¥–∞–µ–º –ø–æ –∫–æ–¥—É
    if info.get('material') and not info.get('type'):
        return (
            'UNSURE',
            0.40,
            f"–û–ø—Ä–µ–¥–µ–ª—ë–Ω –º–∞—Ç–µ—Ä–∏–∞–ª: {info['material']}. "
            "–§–æ—Ä–º–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞ ‚Äî –∫–æ–¥ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ñ–æ—Ä–º—ã (–ª–∏—Å—Ç/–ø—Ä—É—Ç–æ–∫/–ª–µ–Ω—Ç–∞/–ø—Ä–æ–≤–æ–ª–æ–∫–∞/—Ç—Ä—É–±–∞).",
            info
        )
    
    # 2) –ü–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º (–ì–û–°–¢, DIN, ISO)
    # –ì–û–°–¢
    for gost in info['gost']:
        if gost in GOST2OKPD:
            code = GOST2OKPD[gost]
            return okpd_canon(code) or code, 0.93, f"–ì–û–°–¢ {gost}", info
    
    # DIN
    if info['din'] and info['din'] in DIN2OKPD:
        code = DIN2OKPD[info['din']]
        return okpd_canon(code) or code, 0.92, f"DIN {info['din']}", info
    
    # ISO
    if info['iso']:
        iso_num = info['iso'].split('-')[0].split('.')[0]
        if iso_num in ISO2OKPD:
            code = ISO2OKPD[iso_num]
            return okpd_canon(code) or code, 0.92, f"ISO {info['iso']}", info
    
    type_mapping = {
        # –ú–µ—Ç–∞–ª–ª–æ–ø—Ä–æ–∫–∞—Ç
        '–ü–õ–ò–¢–ê':        '24.10.31.000',   # –ª–∏—Å—Ç –≥/–∫ ‚â•600 –º–º (–Ω–µ–ª–µ–≥–∏—Ä.) 
        '–õ–ò–°–¢':         '24.10.41.000',   # –ª–∏—Å—Ç —Ö/–∫ ‚â•600 –º–º (–Ω–µ–ª–µ–≥–∏—Ä.) ‚Äî –ø—Ä–∏ ¬´–≥/–∫¬ª –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å –Ω–∞ 24.10.31.000
        '–ö–†–£–ì':         '24.10.62.121',   # —Å–æ—Ä—Ç–æ–≤–æ–π –≥/–∫ –∫—Ä—É–≥
        '–ü–†–£–¢–û–ö':       '24.31.10.110',   # –ø—Ä—É—Ç–æ–∫ —Ö–æ–ª–æ–¥–Ω–æ—Ç—è–Ω—É—Ç—ã–π (–µ—Å–ª–∏ ¬´–≥–æ—Ä—è—á–µ–∫–∞—Ç–∞–Ω—ã–π –ø—Ä—É—Ç–æ–∫¬ª ‚Äî —ç—Ç–æ –ö–†–£–ì 24.10.62.121)
        '–ö–í–ê–î–†–ê–¢':      '24.10.62.122',
        '–®–ï–°–¢–ò–ì–†–ê–ù–ù–ò–ö': '24.10.62.123',
        '–ü–û–õ–û–°–ê':       '24.10.62.124',
        '–õ–ï–ù–¢–ê':        '24.32.10.000',       # —Ö/–∫ <600 –º–º (—É—Ç–æ—á–Ω—è—Ç—å –ø–æ–¥–≤–∏–¥ –ø—Ä–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
        '–ü–†–û–§–ò–õ–¨':      '24.10.71',       # –Ω–µ–∑–∞–º–∫–Ω—É—Ç—ã–µ –≥–æ—Ä—è—á–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ (—É–≥–æ–ª–∫–∏/—à–≤–µ–ª–ª–µ—Ä—ã/–¥–≤—É—Ç–∞–≤—Ä—ã –ø–æ–ø–∞–¥–∞—é—Ç —Å—é–¥–∞)
        '–£–ì–û–õ–û–ö':       '24.10.71',
        '–®–í–ï–õ–õ–ï–†':      '24.10.71',
        '–î–í–£–¢–ê–í–†':      '24.10.71',
        '–ë–ê–õ–ö–ê':        '24.10.71',
        '–¢–†–£–ë–ê':        '24.20',          # —Å–µ–º–µ–π—Å—Ç–≤–æ —Ç—Ä—É–± (–±/—à, –≠–°–í –∏ –ø—Ä. ‚Äî —É—Ç–æ—á–Ω—è—Ç—å –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –¥–∞–Ω–Ω—ã—Ö)

        # –ö—Ä–µ–ø—ë–∂
        '–ë–û–õ–¢':         '25.94.11.110',
        '–í–ò–ù–¢':         '25.94.11.120',
        '–ì–ê–ô–ö–ê':        '25.94.11.130',
        '–®–ê–ô–ë–ê':        '25.94.12.110',
        '–®–¢–ò–§–¢':        '25.94.12.190',
        '–®–ü–ò–õ–¨–ö–ê':      '25.94.11.140',

        # –ó–∞–≥–æ—Ç–æ–≤–∫–∏ / –ª–∏—Ç—å—ë / –∫–æ–≤–∫–∞
        '–ó–ê–ì–û–¢–û–í–ö–ê':    '24.10.21.190',   # –ø–æ–ª—É—Ñ–∞–±—Ä–∏–∫–∞—Ç—ã –ø—Ä–æ—á–∏–µ (–Ω–µ–ª–µ–≥–∏—Ä.)
        '–û–¢–õ–ò–í–ö–ê':      '24.10.21.190',   # –∫–∞–∫ —Å—Ç–∞–ª—å–Ω–∞—è –ª–∏—Ç–∞—è –∑–∞–≥–æ—Ç–æ–≤–∫–∞ (–µ—Å–ª–∏ –∑–∞–∫—É–ø–∞–µ—Ç—Å—è —É—Å–ª—É–≥–∞ –ª–∏—Ç—å—è ‚Äî 24.52.10.000)
        '–ü–û–ö–û–í–ö–ê':      '24.10.21.142',   # –ø–æ–ª—É—Ñ–∞–±—Ä–∏–∫–∞—Ç—ã –∫–æ–≤–∞–Ω—ã–µ –∫—Ä—É–≥–ª./–º–Ω–æ–≥–æ—É–≥. (–Ω–µ–ª–µ–≥–∏—Ä.)

        # –ü—Ä–æ—á–µ–µ
        '–ü–†–û–í–û–õ–û–ö–ê':    '24.34',
        '–ö–ê–ù–ê–¢':        '25.93.11.120',   # –∫–∞–Ω–∞—Ç—ã –∏ —Ç—Ä–æ—Å—ã —Å—Ç–∞–ª—å–Ω—ã–µ
        '–¢–†–û–°':         '25.93.11.120',
        '–°–ï–¢–ö–ê':        '25.93.13',
    }

    
    if info['type'] in type_mapping and type_mapping[info['type']]:
        base_code = type_mapping[info['type']]
        return okpd_canon(base_code) or base_code, 0.85, f"{info['type'].lower()}", info
    
    # –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–ª—É—á–∞–∏
    if '–º–æ–¥–µ–ª—å–Ω–∞—è –æ—Å–Ω–∞—Å—Ç–∫–∞' in text.lower():
        if '–¥–µ—Ä–µ–≤–æ' in text.lower():
            return '16.29.14', 0.80, '–º–æ–¥–µ–ª—å–Ω–∞—è –æ—Å–Ω–∞—Å—Ç–∫–∞ –¥–µ—Ä–µ–≤—è–Ω–Ω–∞—è', info
        else:
            return '25.73.60', 0.80, '–º–æ–¥–µ–ª—å–Ω–∞—è –æ—Å–Ω–∞—Å—Ç–∫–∞', info
    
    if '–Ω–∞–∫–æ–Ω–µ—á–Ω–∏–∫' in text.lower():
        if '–ª–∞—Ç—É–Ω—å' in text.lower():
            return '24.44.13', 0.85, '–Ω–∞–∫–æ–Ω–µ—á–Ω–∏–∫ –ª–∞—Ç—É–Ω–Ω—ã–π', info
        else:
            return '25.99.29', 0.80, '–Ω–∞–∫–æ–Ω–µ—á–Ω–∏–∫', info
    
    return 'UNSURE', 0.20, '–Ω–µ —É–¥–∞–ª–æ—Å—å –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å', info

def guess_okpd2(name: str) -> Tuple[str, float, str]:
    """–£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏"""
    code, conf, desc, _ = classify_factory_item(name)
    return code, conf, desc

# --- –ê–ø—Å–µ—Ä—Ç—ã –∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–æ–∫ ---
def upsert_label(cur, ns: str, code: str, title: Optional[str], path: Optional[List[str]]) -> int:
    """–í—Å—Ç–∞–≤–∫–∞ –∏–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∫–∏ –≤ –ë–î"""
    cur.execute("""
        INSERT INTO labels(ns, code, title, path)
        VALUES (%s, %s, %s, %s)
        ON CONFLICT (ns, code) DO UPDATE SET
          title = COALESCE(EXCLUDED.title, labels.title),
          path  = COALESCE(EXCLUDED.path,  labels.path)
        RETURNING id
    """, (ns, code, title, path))
    return cur.fetchone()[0]

def attach_label(cur, doc_id: int, ns: str, code: str, conf: Optional[float]=None,
                 title: Optional[str]=None, path: Optional[List[str]]=None):
    """–ü—Ä–∏–≤—è–∑–∫–∞ –º–µ—Ç–∫–∏ –∫ –¥–æ–∫—É–º–µ–Ω—Ç—É"""
    if ns == 'okpd':
        code = okpd_canon(code) or code
        path = path or okpd_breadcrumb(code)
    lid = upsert_label(cur, ns, code, title, path)
    cur.execute("""
        INSERT INTO docs_labels(doc_id, label_id, conf)
        VALUES (%s, %s, %s)
        ON CONFLICT (doc_id, label_id) DO UPDATE SET
            conf = COALESCE(EXCLUDED.conf, docs_labels.conf)
    """, (doc_id, lid, conf))

def extract_labels_from_text(text: str) -> List[Dict]:
    """–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤—Å–µ—Ö –º–µ—Ç–æ–∫ –∏–∑ —Ç–µ–∫—Å—Ç–∞"""
    labels: List[Dict] = []
    
    # –ì–û–°–¢ ‚Äî –≤—Å–µ –≤—Ö–æ–∂–¥–µ–Ω–∏—è
    seen_gost = set()
    for m in GOST_RE.finditer(text or ''):
        g = gost_norm(m.group(0))
        if g and g not in seen_gost:
            seen_gost.add(g)
            labels.append({'ns':'gost','code': g,'path': gost_breadcrumb(g),'conf': 0.95})
    
    # –û–ö–ü–î
    labels.extend(extract_okpd_labels(text))
    
    # –û–°–¢
    for m in OST_RE.findall(text or ''):
        labels.append({'ns':'ost', 'code': m.strip(), 'path': None, 'conf': 0.7})
    
    # –¢–£
    for m in TU_RE.findall(text or ''):
        labels.append({'ns':'tu', 'code': m.strip(), 'path': None, 'conf': 0.7})
    
    # DIN
    for m in DIN_RE.findall(text or ''):
        labels.append({'ns':'din', 'code': m.strip(), 'path': None, 'conf': 0.75})
    
    # ISO
    for m in ISO_RE.findall(text or ''):
        labels.append({'ns':'iso', 'code': m.strip(), 'path': None, 'conf': 0.75})
    
    return labels

# –≠–∫—Å–ø–æ—Ä—Ç –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
__all__ = [
    'okpd_canon', 'okpd_norm', 'okpd_breadcrumb', 'okpd_findall',
    'gost_norm', 'gost_breadcrumb',
    'extract_features', 'extract_material_info',
    'extract_okpd_labels', 'extract_labels_from_text',
    'guess_okpd2', 'classify_factory_item',
    'upsert_label', 'attach_label',
    'GOST2OKPD', 'DIN2OKPD', 'ISO2OKPD', 'MATERIAL_GRADES', 'FAMILY'
]